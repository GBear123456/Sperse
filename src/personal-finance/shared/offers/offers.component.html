<div class="container wrapper">
    <header>
        <h1>{{ categoryDisplayName$ | async }}</h1>
    </header>
    <div class="row main">
        <div class="filter-side-bar xs-hidden col-md-3" #filtersSideBar>
            <dx-scroll-view [height]="scrollHeight">
                <ul class="filters">
                    <ng-container *ngFor="let filter of filters">
                        <li *ngIf="filter.values.length">
                            <div class="filterName">{{ filter.name }}</div>
                            <ng-container *ngFor="let filterValue of filter.values; let i = index">
                                <mat-checkbox *ngIf="filter.showAll || i < maxDisplayedFilterValues" (change)="selectedFilter.next(filtersValues)" [(ngModel)]="filtersValues[filter.field][filterValue]">
                                    <span *ngIf="!filter.type">{{ filterValue }}</span>
                                    <stars-rating *ngIf="filter.type === 'rating'" [maxRating]="filterValue"></stars-rating>
                                </mat-checkbox>
                            </ng-container>
                            <button class="viewMore" *ngIf="!filter.showAll" (click)="filter.showAll = true">{{ ls.l('Offers_ViewMore') }}</button>
                        </li>
                    </ng-container>
                </ul>
            </dx-scroll-view>
        </div>
        <div class="col-sm-12 col-md-9" #creditCardsList>
            <div class="subHeader" [hidden]="creditCardsAmount === undefined">
                <div class="foundCount">
                    {{ ls.l('Offers_WeFound') }} <span>{{ creditCardsAmount }}</span> {{ categoryDisplayName$ | async }}
                </div>
                <div class="sortBy">
                    <span class="m--hidden-mobile">{{ ls.l('Offers_SortBy') }}</span>
                    <mat-select (selectionChange)="selectedSorting.next($event.value);" [value]="sortings[0].field" #sortingSelect>
                        <mat-option *ngFor="let sorting of sortings" [value]="sorting.field">
                            {{ sorting.name }}
                        </mat-option>
                    </mat-select>
                </div>
                <div class="mobileButtons m--hidden-tablet m--hidden-desktop">
                    <button class="btn btn-secondary sortingButton" (click)="toggleSorting($event)"></button>
                    <button class="btn-btn-secondary filteringButton" (click)="toggleFiltering($event)"></button>
                </div>
            </div>
            <dx-scroll-view [height]="scrollHeight" *ngIf="creditCardsAmount">
                <ul class="credit-cards-list">
                    <li class="row" *ngFor="let creditCardItem of displayedCreditCards$ | async">
                        <div class="image col-12 col-md-4 col-lg-3">
                            <img [src]="creditCardItem.logoUrl" [alt]="creditCardItem.name" (click)="viewCardDetails(creditCardItem)">
                        </div>
                        <div class="description col-12 col-md-8 col-lg-6">
                            <h4><span *ngIf="creditCardItem.bankName">{{ creditCardItem.bankName }} + ' - '</span>{{creditCardItem.name }}</h4>
                            <div class="rating" *ngIf="creditCardItem.rating">
                                <stars-rating [currentRating]="creditCardItem.rating" color="#f0d500"></stars-rating>
                                <span>({{ creditCardItem.reviewsAmount + ' ' + ls.l('Offers_reviews') }})</span>
                            </div>
                            <ul class="descriptionItems">
                                <ng-container *ngFor="let param of ['annualFee', 'rewardsRate', 'rewardsBonus', 'apr']">
                                    <li *ngIf="creditCardItem[param]">
                                        <h5>{{ ls.l('Offers_' + param) }}</h5>
                                        <p>{{ creditCardItem[param] }}</p>
                                    </li>
                                </ng-container>
                            </ul>
                        </div>
                        <div class="actions col-12 offset-md-3 col-md-9 offset-lg-0 col-lg-3 ">
                            <button class="applyButton" (click)="applyOffer(creditCardItem)"><span>{{ ls.l('Apply') }}</span></button>
                            <button class="viewMore" (click)="viewCardDetails(creditCardItem)">{{ ls.l('View_details') }}</button>
                        </div>
                    </li>
                </ul>
            </dx-scroll-view>
            <app-no-data *ngIf="creditCardloaded && creditCardsAmount === 0"></app-no-data>
        </div>
    </div>
</div>
