<div class="container wrapper content-wrap">
    <header>
        <h1>{{ ls.l('Offers_CreditCards') }}</h1>
        <div class="subHeader">
            <div class="foundCount">
                {{ ls.l('Offers_WeFound') }} <span>{{ creditCardsAmount }}</span> {{ ls.l('Offers_FoundCreditCards') }}
            </div>
            <div class="sortBy">
                <span class="m--hidden-mobile">{{ ls.l('Offers_SortBy') }}</span>
                <mat-select (selectionChange)="selectedSorting.next($event.value);" [value]="sortings[0].field" #sortingSelect>
                    <mat-option *ngFor="let sorting of sortings" [value]="sorting.field">
                        {{ sorting.name }}
                    </mat-option>
                </mat-select>
            </div>
            <div class="mobileButtons m--hidden-tablet m--hidden-desktop">
                <button class="btn btn-secondary sortingButton" (click)="showSorting($event)"></button>
                <button class="btn-btn-secondary filteringButton" (click)="showFiltering($event)"></button>
            </div>
        </div>
    </header>
    <div class="row main">
        <div class="filter-side-bar xs-hidden col-md-3" #filtersSideBar>
            <dx-scroll-view [height]="scrollHeight">
                <ul class="filters">
                    <ng-container *ngFor="let filter of filters">
                        <li *ngIf="filter.values.length">
                            <div class="filterName">{{ filter.name }}</div>
                            <ng-container *ngFor="let filterValue of filter.values; let i = index">
                                <mat-checkbox *ngIf="filter.showAll || i < maxDisplayedFilterValues" (change)="selectedFilter.next(filtersValues)" [(ngModel)]="filtersValues[filter.field][filterValue]">
                                    <span *ngIf="!filter.type">{{ filterValue }}</span>
                                    <stars-rating *ngIf="filter.type === 'rating'" [maxRating]="filterValue"></stars-rating>
                                </mat-checkbox>
                            </ng-container>
                            <button class="viewMore" *ngIf="!filter.showAll" (click)="filter.showAll = true">{{ ls.l('Offers_ViewMore') }}</button>
                        </li>
                    </ng-container>
                </ul>
            </dx-scroll-view>
        </div>
        <div class="col-sm-12 col-md-9" #creditCardsList>
            <dx-scroll-view [height]="scrollHeight">
                <ul class="credit-cards-list">
                    <li class="row" *ngFor="let creditCardItem of displayedCreditCards$ | async">
                        <div class="image col-3 col-md-4 col-lg-3">
                            <img [src]="'./assets/common/images/payments/card-logo/mastercard.svg'" [alt]="creditCardItem.cardName">
                        </div>
                        <div class="description col-9 col-md-8 col-lg-6">
                            <h4>{{ creditCardItem.bankName + ' - ' + creditCardItem.cardName }}</h4>
                            <div class="rating">
                                <stars-rating [currentRating]="creditCardItem.rating"></stars-rating>
                                <span>({{ creditCardItem.reviewsAmount + ' ' + ls.l('Offers_reviews') }})</span>
                            </div>
                            <ul class="descriptionItems">
                                <li>
                                    <h5>{{ ls.l('Offers_AnnualFee') }}</h5>
                                    <p>{{ creditCardItem.annualFee }}</p>
                                </li>
                                <li>
                                    <h5>{{ ls.l('Offers_RewardsRate') }}</h5>
                                    <p>{{ creditCardItem.rewardsRate }}</p>
                                </li>
                                <li>
                                    <h5>{{ ls.l('Offers_RewardsBonus') }}</h5>
                                    <p>{{ creditCardItem.rewardsBonus }}</p>
                                </li>
                                <li>
                                    <h5>{{ ls.l('Offers_APR') }}</h5>
                                    <p>{{ creditCardItem.apr }}</p>
                                </li>
                            </ul>
                        </div>
                        <div class="actions col-sm-12 col-lg-3">
                            <button class="applyButton" (click)="applyCard(creditCardItem)"><span>{{ ls.l('Apply') }}</span></button>
                            <button class="viewMore" (click)="viewCardDetails(creditCardItem)">{{ ls.l('View_details') }}</button>
                        </div>
                    </li>
                </ul>
            </dx-scroll-view>
        </div>
    </div>
</div>
