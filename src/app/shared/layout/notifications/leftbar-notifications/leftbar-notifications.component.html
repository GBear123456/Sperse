<div class="m-dropdown__wrapper notification-header">
  <div class="m-dropdown__inner">
    <div
      class="m-dropdown__header"
      style="
        background: linear-gradient(to right, #43383b 60%, gray);
        box-shadow: inset 2px 5px 12px 2px #43383b;
        padding: 20px;
      "
    >
      <div class="row">
        <div *ngIf="!subscriptionStatusBarVisible(); else subscriptionStatusBar" class="user-info">
          <div class="m-card-user m-card-user--skin-dark">
            <div class="m-card-user__details">
              <span class="tenantName"> {{ ls.l('NotificationsFor') }}: </span> <br />
              <span class="fullName">
                {{ shownLoginInfo.fullName }}
              </span>
            </div>
            <div class="m-card-user__pic" *ngIf="appSession?.user?.profileThumbnailId">
              <img
                alt=""
                [ngClass]="{ squere: layoutService.showLeftBar }"
                class="header-profile-picture m--img-rounded m--marginless m--img-centered"
                [src]="profileService.getProfilePictureUrl(appSession.user.profileThumbnailId)"
              />
            </div>
          </div>
        </div>
        <ng-template #subscriptionStatusBar>
          <div class="subscription-info">
            <div class="details">
              <div class="vertical-align">
                <span class="title" (click)="openPaymentWizardDialog($event, true)">{{
                  subscriptionInfoTitle
                }}</span>
                <br />
                <span>{{ subscriptionInfoText }}</span>
              </div>
            </div>
            <div
              *ngIf="prolongButtonVisible()"
              class="upgrade-button"
              (click)="openPaymentWizardDialog($event)"
            >
              <div class="">
                {{ ls.l(isOneTimeSubscription() ? 'Activate' : 'Prolong').toUpperCase() }}
              </div>
              <div class="">{{ ls.l(isOneTimeSubscription() ? 'Now' : 'Today') }}</div>
            </div>
          </div>
        </ng-template>
      </div>
    </div>
    <div class="m-dropdown__body" style="padding: 20px">
      <div class="m-dropdown__content">
        <div class="row">
          <div class="text-left col-md-6">
            <a (click)="openAllNotifications($event)" href="javascript:;">{{
              ls.l('SeeAllNotifications')
            }}</a>
          </div>
          <div class="text-right col-md-6">
            <a
              *ngIf="unreadNotificationCount"
              href="javascript:;"
              class="text-right"
              (click)="
                setAllNotificationsAsRead(); $event.preventDefault(); $event.stopPropagation()
              "
            >
              {{ ls.l('SetAllAsRead') }}
            </a>
          </div>
        </div>
        <hr />
        <div class="m-scrollable" data-scrollable="true">
          <div class="m-list-timeline m-list-timeline--skin-light m-nav">
            <div class="m-list-timeline__items" [ngClass]="{ empty: !notifications.length }">
              <div
                *ngFor="let notification of notifications"
                class="m-list-timeline__item user-notification-item"
                [ngClass]="{
                  'user-notification-item-clickable': notification.url,
                  'user-notification-item-unread': notification.isUnread
                }"
                (click)="onNotificationClick(notification)"
              >
                <span
                  class="m-list-timeline__badge m-list-timeline__badge--{{
                    notification.isUnread ? 'success' : 'metal'
                  }}"
                ></span>
                <span class="m-list-timeline__icon {{ notification.icon }}"></span>
                <span class="m-list-timeline__text">
                  {{ notification.text }}
                </span>
                <span class="m-list-timeline__time" jq-plugin="timeago">
                  {{ notification.time }}
                  <span *ngIf="notification.isUnread">
                    <a
                      href="javascript:;"
                      *ngIf="notification.state == 'UNREAD'"
                      class="m-link set-notification-as-read"
                      (click)="
                        setNotificationAsRead(notification);
                        $event.preventDefault();
                        $event.stopPropagation()
                      "
                      >{{ ls.l('SetAsRead') }}</a
                    >
                  </span>
                </span>
              </div>
              <span *ngIf="!notifications.length" class="notification-empty-text">
                {{ ls.l('ThereIsNoNotification') }}
              </span>
            </div>
            <ng-container *ngIf="notifications.length">
              <div class="m-nav__separator m-nav__separator--fit"></div>
              <div class="external notifications-footer">
                <div class="text-left">
                  <a (click)="openNotificationSettingsModal($event)" href="javascript:;">{{
                    ls.l('Preferences')
                  }}</a>
                </div>
              </div>
            </ng-container>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
