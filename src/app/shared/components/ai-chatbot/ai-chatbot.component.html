<!-- AI Chatbot Toggle Button -->
<div class="ai-chatbot-toggle" *ngIf="!isOpen" (click)="toggleChatbot()">
  <div class="chatbot-icon">
    <img src="assets/common/icons/AI.png" alt="AI Assistant" class="chatbot-icon-img">
  </div>
  <div class="chatbot-badge" *ngIf="isTyping">
    <div class="typing-indicator">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
</div>

<!-- AI Chatbot Window -->
<div class="ai-chatbot-window" *ngIf="isOpen" [ngClass]="{ 'minimized': isMinimized }">
  <!-- Header -->
  <div class="chatbot-header">
    <div class="chatbot-title">
      <img src="assets/common/icons/AI.png" alt="AI Assistant" class="chatbot-title-icon">
      <span>AI Assistant</span>
    </div>
    <div class="chatbot-controls">
      <button class="control-btn minimize-btn" (click)="minimizeChatbot()" *ngIf="!isMinimized" title="Minimize">
        <img src="assets/common/icons/arrow-down.svg" alt="Minimize" class="control-icon">
      </button>
      <button class="control-btn maximize-btn" (click)="maximizeChatbot()" *ngIf="isMinimized" title="Maximize">
        <img src="assets/common/icons/maximize.svg" alt="Maximize" class="control-icon">
      </button>
      <button class="control-btn close-btn" (click)="toggleChatbot()" title="Close">
        <img src="assets/common/icons/close.svg" alt="Close" class="control-icon">
      </button>
    </div>
  </div>

  <!-- Chat Content -->
  <div class="chatbot-content" *ngIf="!isMinimized">
    <!-- Messages Container -->
    <div class="messages-container" #messageContainer>
      <div class="message" *ngFor="let message of messages" [ngClass]="message.role">
        <div class="message-avatar">
          <img *ngIf="message.role === 'user'" src="assets/common/icons/person.svg" alt="User" class="avatar-icon">
          <img *ngIf="message.role === 'assistant'" src="assets/common/icons/AI.png" alt="AI Assistant" class="avatar-icon">
        </div>
        <div class="message-content">
          <div class="message-text" [innerHTML]="formatMessage(message.content)"></div>
          <div class="message-time">{{ getMessageTime(message.timestamp) }}</div>
        </div>
      </div>

      <!-- Typing Indicator -->
      <div class="message assistant typing" *ngIf="isTyping">
        <div class="message-avatar">
          <img src="assets/common/icons/AI.png" alt="AI Assistant" class="avatar-icon">
        </div>
        <div class="message-content">
          <div class="typing-indicator">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Suggestions -->
    <div class="quick-suggestions" *ngIf="showSuggestions && messages.length <= 1">
      <div class="suggestions-title">Quick Start:</div>
      <div class="suggestion-chips">
        <button 
          class="suggestion-chip" 
          *ngFor="let suggestion of quickSuggestions" 
          (click)="sendQuickSuggestion(suggestion)">
          {{ suggestion }}
        </button>
      </div>
    </div>

    <!-- Input Area -->
    <div class="input-area">
      <div class="input-container">
        <textarea
          #messageInput
          [(ngModel)]="currentMessage"
          (keypress)="onKeyPress($event)"
          placeholder="Ask me anything about the platform..."
          class="message-input"
          rows="1"
          [disabled]="isTyping">
        </textarea>
        <button 
          class="send-button" 
          (click)="sendMessage()" 
          [disabled]="!currentMessage.trim() || isTyping"
          title="Send message">
          <img src="assets/common/icons/send.svg" alt="Send" class="send-icon">
        </button>
      </div>
      <div class="input-actions">
        <button class="action-btn" (click)="clearConversation()" title="Clear conversation">
          <img src="assets/common/icons/trash.svg" alt="Clear" class="action-icon">
        </button>
      </div>
    </div>
  </div>
</div>
