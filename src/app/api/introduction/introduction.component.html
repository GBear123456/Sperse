<div>
    <app-headline [names]="[ l('Interactive API Documentation') ]"                  
                  [showReloadButton]="ui.showReload"
                  [showToggleLeftMenuButton]="true"
                  (onReload)="loadApiKeys()">
        <button class="btn btn-layout gen-button" (click)="addUpdateApiKey()">{{ l('API_Intro_GenerateKey') }}</button>
    </app-headline>
    <div class="content">
        <api-left-menu></api-left-menu>
        <i class="info-tooltip fa fa-info"
           id="infoTarget"
           (mouseenter)="showTooltip()">
        </i>
        <dx-tooltip target="#infoTarget"
                    [(visible)]="toggleTooltip"
                    [width]="370"
                    [height]="140"
                    [closeOnOutsideClick]="true">
            <div *dxTemplate="let data = data of 'content'">
                <div class="tooltip-data">
                    <h6>{{l('Api_Intro_Text')}}:</h6>
                    <ul>
                        <li><b>{{l('API_Api-Key')}}:</b> XXXXXX-XXXXXX-XXXXXX-XXXXXX-XXXXXX</li>
                        <li><b>{{l('Accept')}}:</b> {{l('API_Application-Json')}}</li>
                        <li><b>{{l('API_Content_Type')}}:</b> {{l('API_Application-Json')}}</li>
                    </ul>
                    <h6>{{l('Api_Intro_Text_2')}}</h6>
                </div>
            </div>
        </dx-tooltip>
        <div class="api-into portlet light no-padding margin-bottom-0">
            <api-welcome [small]="apiKeys"></api-welcome>
            <div *ngIf="apiKeys">
                <dx-data-grid id="gridContainer"
                              keyExpr="id"
                              height="calc(100vh - 400px)"
                              accessKey="API_DataGrid"
                              [scrolling]="{showScrollbar:'onHover'}"
                              [dataSource]="apiKeys">
                    <dxi-column dataField="name" [caption]="l('ApiKey_Name')" cssClass="clipboard-holder"></dxi-column>
                    <dxi-column dataField="key" [caption]="l('ApiKey_Key')" cellTemplate="keyTemplate" width="420px"></dxi-column>
                    <dxi-column dataField="expirationDate" [caption]="l('ApiKey_ExpirationDate')" cellTemplate="dateCell" cssClass="tabular"></dxi-column>
                    <dxi-column dataField="creationTime" [caption]="l('CreationTime')" cellTemplate="dateCell" cssClass="tabular"></dxi-column>
                    <dxi-column dataField="userName" [caption]="l('UserName')" width="150px" cssClass="clipboard-holder"></dxi-column>
                    <dxi-column width="120px" [allowFiltering]="false" [allowSorting]="false" [allowReordering]="false" [visible]="canManageApiKeys" cellTemplate="editDeleteTemplate"></dxi-column>
                    <div *dxTemplate="let data of 'editDeleteTemplate'">
                        <a class="dx-link" (click)="addUpdateApiKey(data.data)">{{l('Edit')}}</a>&nbsp;<a class="dx-link" (click)="deleteApiKey(data)">{{l('Delete')}}</a>
                    </div>
                    <div *dxTemplate="let data of 'keyTemplate'" class="key-container" [title]="data.data.key">
                        <span>{{getMaskedKey(data.data.key)}}<i class="save-to-clipboard" (click)="copyToClipboard(data.data.key)"></i></span>
                    </div>
                </dx-data-grid>
            </div>
        </div>
    </div>
</div>
