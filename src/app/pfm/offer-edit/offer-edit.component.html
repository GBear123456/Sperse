<item-details-layout [navLinks]="navLinks" (onClose)="back()">
    <ng-container topHeader>
        <header>
            <ng-container *ngIf="(offerDetails$ | async) as offerDetails">
                <img [src]="offerDetails.logoUrl">
                <inplace-edit
                    [data]="getInplaceEditData()"
                    (valueChanged)="updateCustomName($event)">
                </inplace-edit>
            </ng-container>
            <button class="btn btn-layout" type="submit" (click)="onSubmit()">Save</button>
        </header>
    </ng-container>
    <ng-container mainContent>
        <form>
            <div class="row">
                <ng-container *ngFor="let detail of filteredBySectionDetails$ | async" >
                    <div [ngClass]="['detail', getColumnClass(detail)]" ng-container *ngIf="detailsToHide.indexOf(detail) === -1">
                        <ng-container *ngIf="isEnum(detail); else a">
                            <div class="field">
                                <ng-container *ngIf="startCase(detail) as detailDisplayValue">
                                    <label [for]="detail" [title]="detailDisplayValue">{{ detailDisplayValue }}</label>
                                </ng-container>
                                <div class="drop-down-box-wrapper">
                                    <ng-container *ngIf="isMultiple(detail); else single">
                                        <dx-tag-box
                                            [inputAttr]="{ id: detail }"
                                            [placeholder]="ls.l('Select')"
                                            [dataSource]="keys(detailsEnums[detail])"
                                            [(value)]="model[detail]"
                                            [disabled]="isReadOnly(detail)">
                                        </dx-tag-box>
                                    </ng-container>
                                    <ng-template #single>
                                        <dx-select-box
                                            [inputAttr]="{ id: detail }"
                                            [placeholder]="ls.l('Select')"
                                            [dataSource]="keys(detailsEnums[detail])"
                                            [(value)]="model[detail]"
                                            [disabled]="isReadOnly(detail)">
                                        </dx-select-box>
                                    </ng-template>
                                </div>
                            </div>
                        </ng-container>
                        <ng-template #a>
                            <ng-container *ngIf="isRatingDetail(detail); else b">
                                <div class="field">
                                    <ng-container *ngIf="startCase(detail) as detailDisplayValue">
                                        <label [title]="detailDisplayValue">{{ detailDisplayValue }}</label>
                                    </ng-container>
                                    <stars-rating [isEditable]="true" [(currentRating)]="model[detail]" color="#f0d500"></stars-rating>
                                </div>
                            </ng-container>
                            <ng-template #b>
                                <ng-container *ngIf="isPrimitive(model[detail])">
                                    <div class="field" *ngIf="!isBool(model[detail])">
                                        <ng-container *ngIf="startCase(detail) as detailDisplayValue">
                                            <label [for]="detail" [title]="detailDisplayValue">{{ detailDisplayValue }}</label>
                                        </ng-container>
                                        <dx-text-box [inputAttr]="{ id: detail }"
                                                     [valueChangeEvent]="'focusout'"
                                                     [(value)]="model[detail]"
                                                     [placeholder]="!isReadOnly(detail) ? ls.ls('PFM', 'Enter_Value') : ''"
                                                     [disabled]="isReadOnly(detail)"
                                                     (onValueChanged)="onTextBoxChange($event, detail)">
                                        </dx-text-box>
                                        <span [ngClass]="model[detail] && !isReadOnly(detail) && 'clear-contact' || 'hidden'" (click)="model[detail] = ''"><i class="minus-icon"></i></span>
                                    </div>

                                    <div class="field" *ngIf="isBool(model[detail])">
                                        <ng-container *ngIf="startCase(detail) as detailDisplayValue">
                                            <label [for]="detail" [title]="detailDisplayValue">{{ detailDisplayValue }}</label>
                                        </ng-container>
                                        <dx-check-box [(value)]="model[detail]" [disabled]="isReadOnly(detail)"></dx-check-box>
                                    </div>
                                </ng-container>

                                <div *ngIf="isArray(model[detail]); else object">
                                    <div class="field">
                                        <ng-container *ngIf="startCase(detail) as detailDisplayValue">
                                            <label [title]="detailDisplayValue">{{ detailDisplayValue }}</label>
                                        </ng-container>
                                        <div>
                                            <div *ngFor="let value of model[detail]; let i=index" class="detailItem">
                                                <dx-text-box [valueChangeEvent]="'focusout'"
                                                             [placeholder]="!isReadOnly(detail) ? ls.ls('PFM', 'Enter_Value') : ''"
                                                             [(value)]="model[detail][i]">
                                                </dx-text-box>
                                                <span class="clear-contact" (click)="remove(model[detail], i)"><i class="minus-icon"></i></span>
                                            </div>
                                            <div *ngIf="!isReadOnly(detail)" class="add-new-button" (click)="addNew(model[detail], value)">
                                                <span>+ Add new</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <ng-template #object>
                                    <div *ngIf="isObject(model[detail])">
                                        <div class="field" *ngFor="let value of getKeys(model[detail])">
                                            <label>{{ startCase(value) }}</label>
                                            <dx-check-box [(value)]="!!model[detail][value]"></dx-check-box>
                                        </div>
                                    </div>
                                </ng-template>
                            </ng-template>
                        </ng-template>
                    </div>
                </ng-container>
            </div>
        </form>
    </ng-container>
</item-details-layout>
