<div [@routerTransition]>
    <app-headline [names]="[ l('Setup_Title'), l('SetupStep_Chart') ]"
                  iconSrc="./assets/common/icons/magic-stick-icon.svg"></app-headline>
    <div class="content-wrap">
        <setup-steps #setupStep SelectedStepIndex="2"></setup-steps>
        <div class="grid-wrapper" [ngStyle]="{flex: isInstanceAdmin ? 'unset': 1}">
            <categorization [width]="'calc(100vw - ' + (setupStep.collapsed ? 420 : 744) + 'px)'"
                            [height]="'calc(100vh - 218px)'"
                            [showTitle]="false"
                            [showHeader]="true"
                            [showClearSelection]="false"
                            [showFilterIcon]="false"
                            [showAddEntity]="true"
                            [includeNonCashflowNodes]="true">
            </categorization>
        </div>
        <div class="right-actions" *ngIf="isInstanceAdmin">
            <div>
                <p class="title">{{l('CustomCharts_Title')}}</p>
                <div class="links-wrap">
                    <i class="arrow-icon"></i>
                    <import-quick-book-button (onClose)="refreshCategories()" [override]="override"></import-quick-book-button>
                </div>
                <hr style="width: calc(100% - 70px); margin-left: 70px;"/>
                <div class="links-wrap">
                    <i class="arrow-icon"></i>
                    <import-xero-chart-of-accounts-button (onComplete)="refresh()" [override]="override"></import-xero-chart-of-accounts-button>
                </div>
            </div>

            <div>
                <div class="text-center" (click)="downloadExcel()">
                    <p class="links">
                        {{l('CustomCharts_DownloadExcel')}}
                    </p>
                </div>
                <div class="file">
                    <label class="file-upload links">
                        + {{l('CustomCharts_UploadFile')}}
                        <input type="file" (change)="uploadExcel($event)" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" name="+ Upload file" class="no-display" />
                    </label>
                </div>
                <div class="info-text">
                    <dx-check-box text="Override" [(value)]="override" class="override-checkbox"> </dx-check-box>
                    {{l('CustomCharts_InfoText')}}
                </div>
            </div>
        </div>
    </div>

    <dx-data-grid id="gridForExcelContainer" class="hidden-grid" [dataSource]="categorizationComponent.excelData">
        <dxo-export [enabled]="true"></dxo-export>
    </dx-data-grid>
</div>
