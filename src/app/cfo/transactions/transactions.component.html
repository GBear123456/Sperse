<div #becFilterContainer class="bec-filter">
    <business-entities-chooser
        width="130px"
        popupWidth="330px"
        [showSearch]="true"
        [applyFilter]="false"
        [showApplySelection]="true"
        (onChanged)="applyTotalBankAccountFilter(true)">
    </business-entities-chooser>
</div>
<div #categoryFilterContainer class="category-filter">
    <dx-drop-down-box
        #categoryFilter
        width="130px"       
        [value]=""
        [placeholder]="(categoriesRowsData?.length ? categoriesRowsData?.length : l('Select')) + ' ' + l('Categor' + (categoriesRowsData?.length > 1 ? 'ies' : 'y')) + ' \u25BE'"
        (onOpened)="onPopupOpened($event)">
        <div #wrapper *dxTemplate="let data of 'content'" style="height: calc(100vh - 400px)">
            <categorization
                width="340px"
                [height]="wrapper.offsetHeight - 60 + 'px'"
                [showTitle]="false"
                [dragMode]="false"
                [showHeader]="true"
                [showSearch]="true"
                [showToolbar]="false"
                [showSelectAll]="true"
                [showFilterIcon]="true"
                [showAddEntity]="false"
                [addingAllowed]="false"
                [showCloseButton]="false"
                [showApplySelection]="true"
                [showClearSelection]="true"
                [filteredRowsData]="filterCategoriesRowsData"
                [transactionsFilter]="transactionsFilterQuery"
                (onFilterSelected)="applyCashflowCategories($event)">
            </categorization>
        </div>
    </dx-drop-down-box>
</div>
<div #counterpartyFilterContainer class="header-dropdown-filter">
    <dx-drop-down-box
        #counterpartyFilter
        width="130px"
        [value]=""
        [placeholder]="(counterpartiesFilter?.isSelected ? counterpartiesFilter?.isSelected : l('Select')) + ' ' + l('Vendor' + (counterpartiesFilter?.isSelected > 1 ? 's' : '')) + ' \u25BE'"
        (onOpened)="onPopupOpened($event)">
        <div *dxTemplate="let data of 'content'" class="header-dropdown">
            <div class="apply-all">
                <span class="btn-apply" (click)="onCounterpartiesChanged(counterpartyComponent)">{{l('Apply')}}</span>
                <span class="btn-clear" (click)="onCounterpartiesClear(counterpartyComponent)">{{l('Clear')}}</span>
            </div>
            <dx-list #counterpartyComponent
                width="340px"
                keyExpr="id"
                searchExpr="name"
                displayExpr="name"
                selectionMode="all"
                [searchEnabled]="true"
                [showSelectionControls]="true"
                [dataSource]="counterparties$ | async"
                (onInitialized)="onCounterpartiesInitialized($event)">
            </dx-list>
        </div>
    </dx-drop-down-box>
</div>
<div #accountFilterContainer class="header-dropdown-filter">
    <dx-drop-down-box
        #accountFilter
        width="130px"
        [value]=""
        [placeholder]="(bankAccountFilter?.isSelected ? bankAccountFilter?.items?.element?.value?.length : l('Select')) + ' ' + l('Account' + (bankAccountFilter?.items?.element?.value?.length > 1 ? 's' : '')) + ' \u25BE'"
        (onOpened)="onPopupOpened($event)">
        <div *dxTemplate="let data of 'content'" class="header-dropdown">
            <div class="apply-all">
                <span class="btn-apply" (click)="onAccountsChanged()">{{l('Apply')}}</span>
                <span class="btn-clear" (click)="onAccountsClear(accountsLookupComponent)">{{l('Clear')}}</span>
            </div>
            <dx-tree-view #accountsLookupComponent
                width="340px"
                keyExpr="id"
                searchExpr="accountName"
                displayExpr="accountName"
                selectionMode="multiple"
                itemsExpr="bankAccounts"
                showCheckBoxesMode="selectAll"
                [searchEnabled]="true"
                [dataSource]="syncAccountsLookup">
            </dx-tree-view>
        </div>
    </dx-drop-down-box>
</div>
<div [@routerTransition]>
    <app-headline [names]="[ l('Transactions') ]"
                  [reloadIsNecessary]="noRefreshedAfterSync"
                  iconSrc="assets/common/icons/credit-card-icon.svg"
                  [buttons]="headlineButtons"
                  [showToggleCompactViewButton]="showToggleCompactViewButton"
                  [showToggleFullScreenButton]="true"
                  [showReloadButton]="ui.showReload"
                  [showToggleToolbarButton]="true"
                  [showToggleTotalsButton]="true"
                  [showToggleColumnSelectorButton]="!_cfoService.hasStaticInstance"
                  [showToggleLeftMenuButton]="false"
                  [showStateResetButton]="true"
                  (onReload)="reload()"
                  (onToggleCompactView)="toggleCompactView()"
                  (onToggleFullScreen)="repaintDataGrid(100)"
                  (onToggleTotals)="toggleDataGridToolbar()"
                  (onToggleToolbar)="toggleToolbar()"
                  (onStateReset)="dataGrid.instance.state(null)"
                  (onToggleColumnSelector)="toggleColumnChooser()">
        <span *ngIf="totalCount" class="total-count">({{ totalCount | number }})</span>
        <business-entities-chooser class="accounts-chooser" (onChanged)="applyTotalBankAccountFilter(true)"
            (onFilterButtonClick)="openBankAccountsSelectDialog()">
        </business-entities-chooser>
        <synch-progress class="synch-progress" (onComplete)="showRefreshButton()"></synch-progress>
        <calendar-button></calendar-button>
    </app-headline>
    <app-toolbar [config]="toolbarConfig" [hidden]="appService.toolbarIsHidden$ | async"></app-toolbar>
    <div class="portlet light no-padding margin-bottom-0">
        <div class="portlet-body">
            <div class="wrapper" [ngClass]="{ 'expanded': categoriesShowed }">
                <div class="categories" *ngIf="!isAdvicePeriod">
                    <categorization #categoriesPanel
                        [hidden]="!toggleTabContent"
                        width="340px"
                        [height]="isFullscreenMode ? 'calc(100vh - 150px)' : 'calc(100vh - 300px)'"
                        [showTitle]="true"
                        [showHeader]="true"
                        [showClearSelection]="true"
                        [showFilterIcon]="true"
                        [dragMode]="dragInProgress"
                        (close)="categoriesShowed = false"
                        [filteredRowsData]="categoriesRowsData"
                        [transactionsFilter]="transactionsFilterQuery"
                        (onTransactionDrop)="categorizeTransactions($event)"
                        (onFilterSelected)="filterByCashflowCategories($event)"
                        (onCategoriesChanged)="refreshDataGrid()">
                    </categorization>
                </div>
                <div class="transactions">
                    <ghost-list [hidden]="isDataLoaded"></ghost-list>
                    <dx-data-grid id="gridContainer"
                        class="limitedPagerTotal main-component-view"
                        [ngClass]="{ showDataGridToolbar: showDataGridToolbar }"
                        [renderAsync]="true"
                        [noDataText]="!dataGrid?.dataSource || dataSource?.isLoading() ? '' : l('NoData')"
                        [allowColumnReordering]="true"
                        [columnAutoWidth]="true"
                        [allowColumnResizing]="true"
                        [hoverStateEnabled]="true"
                        [cacheEnabled]="true"
                        [columnChooser]="{
                          height: rowsViewHeight
                        }"
                        [headerFilter]="{ allowSearch: true, visible: false }"
                        [pager]="defaultGridPagerConfig"
                        [loadPanel]="{ enabled: false }"
                        [height]="gridHeight"
                        [elementAttr]="{ class: 'with-custom-loader' }"
                        (onOptionChanged)="onGridOptionChanged($event)"
                        (onContentReady)="onContentReady($event)"
                        (onDataErrorOccurred)="httpInterceptor.handleError($event.error)"
                        (onSelectionChanged)="onSelectionChanged($event)"
                        (onCellClick)="onCellClick($event)"
                        (onCellPrepared)="onCellPrepared($event)"
                        (onToolbarPreparing)="onToolbarPreparing($event)">
                        <dxo-selection selectAllMode="page"
                                       showCheckBoxesMode="always"
                                       mode="multiple">
                        </dxo-selection>
                        <dxo-paging [pageSize]="20"></dxo-paging>
                        <dxo-scrolling rowRenderingMode="virtual"></dxo-scrolling>
                        <dxo-group-panel [visible]="true"></dxo-group-panel>
                        <dxo-sorting mode="multiple"></dxo-sorting>
                        <dxo-filter-row [visible]="false" [showOperationChooser]="true"></dxo-filter-row>
                        <dxo-export [enabled]="false" [customizeExcelCell]="customizeExcelCell"></dxo-export>

                        <dxi-column [dataField]="transactionFields.Date"
                                    cssClass="tabular"
                                    sortOrder="desc"
                                    [minWidth]="(isHeaderFilterVisible ? 130 : 90) + 'px'"
                                    calculateSortValue="Date"
                                    [renderAsync]="true"
                                    [caption]="l('Transactions_Date')"
                                    [calculateDisplayValue]="calculateDateDisplayValue">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.BusinessEntityId"
                                    [renderAsync]="true"
                                    [caption]="l('Transactions_BusinessEntity')"
                                    [minWidth]="160"
                                    [lookup]="{
                                        allowClearing: false,
                                        dataSource: filtersInitialData?.businessEntities,
                                        displayExpr: 'name',
                                        valueExpr: 'id'
                                    }">
                        </dxi-column>
                        <dxi-column [caption]="l('Transactions_CashflowCategoryName')"
                                    [dataField]="transactionFields.CashflowCategoryName"
                                    [minWidth]="200"
                                    name="cashflowCategoryName"
                                    dataType="string"
                                    [renderAsync]="true"
                                    cellTemplate="CashflowCategoryNameTemplate"
                                    [calculateDisplayValue]="calculateCashflowCategoryNameDisplayValue"
                                    cssClass="category">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.CounterpartyName"
                                    dataType="string"
                                    [caption]="l('Transactions_Vendor')"
                                    [minWidth]="200"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.Description"
                                    cssClass="description-column"
                                    dataType="string"
                                    [name]="l('Description')"
                                    cellTemplate="descriptionTemplate"
                                    [caption]="l('Transactions_Description')">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.Amount"
                                    dataType="number"
                                    cssClass="tabular"
                                    name="Amount"
                                    [caption]="l('Transactions_Amount')"
                                    cellTemplate="amountTemplate"
                                    calculateSortValue="Amount"
                                    [calculateDisplayValue]="calculateTransactionsAmountDisplayValue">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.BankAccountId"
                                    cssClass="tabular clipboard-holder"
                                    minWidth="150px"
                                    [renderAsync]="true"
                                    [caption]="l('Transactions_BankAccountNumber')"
                                    [lookup]="{
                                        allowClearing: false,
                                        dataSource: bankAccountsLookup,
                                        displayExpr: 'accountName',
                                        valueExpr: 'id'
                                    }">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.Comments"
                                    dataType="string"
                                    [caption]="l('Transactions_Comments')"
                                    [visible]="false"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.CategoryName"
                                    dataType="string"
                                    [caption]="l('Transactions_CategoryName')"
                                    [lookup]="{ dataSource: categories }"
                                    [visible]="false"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.CashflowSubCategoryName"
                                    dataType="string"
                                    name="cashflowSubCategoryName"
                                    [caption]="l('Transactions_CashflowSubCategoryName')"
                                    [visible]="false"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.EndingBalance"
                                    dataType="currency"
                                    cssClass="tabular"
                                    [caption]="l('Transactions_EndingBalance')"
                                    cellTemplate="endBalanceTemplate"
                                    [calculateDisplayValue]="calculateEndingBalanceDisplayValue"
                                    calculateSortValue="EndingBalance"
                                    [visible]="false">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.CashFlowTypeName"
                                    dataType="string"
                                    cellTemplate="CashFlowTypeNameTemplate"
                                    cssClass="cashflow-type"
                                    alignment="center"
                                    [lookup]="{ dataSource: ['Inflows', 'Outflows'] }"
                                    [visible]="false"
                                    [caption]="l('Transactions_CashFlowType')">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.AccountingTypeName"
                                    dataType="string"
                                    [caption]="l('Transactions_AccountingTypeName')"
                                    [visible]="false"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.Descriptor"
                                    dataType="string"
                                    [caption]="l('Transactions_Descriptor')"
                                    [visible]="false"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.BankAccountBankName"
                                    dataType="string"
                                    [caption]="l('Transactions_BankName')"
                                    [visible]="false"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.Id"
                                    sortOrder="desc"
                                    cssClass="tabular id-column clipboard-holder"
                                    [caption]="l('Transactions_Id')"
                                    [visible]="false">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.BankCode"
                                    [caption]="l('Transactions_BankCode')"
                                    [visible]="false"
                                    [filterOperations]="'='"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.IsPending"
                                    [caption]="l('Transactions_IsPending')"
                                    [visible]="false"
                                    [renderAsync]="true"
                                    [calculateDisplayValue]="calculateIsPendingDisplayValue"
                                    cellTemplate="isPendingTemplate">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.MonthYear"
                                    [caption]="l('Transactions_MonthYear')"
                                    calculateSortValue="Date"
                                    [renderAsync]="true"
                                    [calculateDisplayValue]="calculateMonthYearDisplayValue"
                                    [visible]="false">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.Debit"
                                    dataType="currency"
                                    cssClass="tabular"
                                    name="Debit"
                                    [renderAsync]="true"
                                    [caption]="l('Transactions_Debit')"
                                    [calculateDisplayValue]="calculateTransactionsDebitDisplayValue"
                                    calculateSortValue="Debit"
                                    cellTemplate="amountTemplate"
                                    [visible]="false">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.Credit"
                                    dataType="currency"
                                    cssClass="tabular"
                                    name="Credit"
                                    [renderAsync]="true"
                                    [caption]="l('Transactions_Credit')"
                                    calculateSortValue="Credit"
                                    [calculateDisplayValue]="calculateTransactionsCreditDisplayValue"
                                    cellTemplate="amountTemplate"
                                    [visible]="false">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.BankAccountTypeName"
                                    [caption]="l('Transactions_BankAccountType')"
                                    [visible]="false"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.Currency"
                                    [caption]="l('Transactions_Currency')"
                                    [visible]="false"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.Fees"
                                    dataType="currency"
                                    cssClass="tabular clipboard-holder"
                                    [caption]="l('Transactions_Fees')"
                                    [visible]="false">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.TypeName"
                                    [renderAsync]="true"
                                    [caption]="l('Transactions_Type')"
                                    [visible]="false"
                                    [lookup]="{dataSource: types}"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.ProviderCashFlowCategoryName"
                                    [caption]="l('Transactions_ProviderCashFlowCategory')"
                                    [visible]="false"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.ProviderCashFlowSubCategoryName"
                                    [caption]="l('Transactions_ProviderCashFlowSubCategory')"
                                    [visible]="false"
                                    cssClass="clipboard-holder">
                        </dxi-column>
                        <dxi-column [dataField]="transactionFields.Department"
                                    dataType="string"
                                    cssClass="clipboard-holder"
                                    [caption]="l('Transactions_Department')"
                                    [visible]="departmentFeatureEnabled"
                                    [showInColumnChooser]="departmentFeatureEnabled">
                        </dxi-column>

                        <div *dxTemplate="let cell of 'amountTemplate'">
                            <ng-container *ngIf="cell.text && ((cell.column.name == 'Amount') || (cell.value < 0 && cell.column.name == 'Debit') || (cell.value >= 0 && cell.column.name == 'Credit'))">
                                <span [class]="'clipboard-holder ' + (cell.value < 0 ? 'negative' : 'positive') + '-values'"> {{ cell.text }} </span>
                            </ng-container>
                        </div>
                        <div *dxTemplate="let cell of 'isPendingTemplate'">
                            <span class="clipboard-holder">{{ cell.text }}</span>
                        </div>
                        <div *dxTemplate="let cell of 'endBalanceTemplate'">
                            <ng-container *ngIf="cell.text">
                                <span class="clipboard-holder end-balance{{cell.data['IsBalanceConfirmed'] ? '' : '-not'}}-confirmed"> {{ cell.text }} </span>
                            </ng-container>
                        </div>
                        <div *dxTemplate="let cell of 'descriptionTemplate'">
                            <span class="clipboard-holder fixed-right transaction-target" id="transactionDetailTarget-{{cell.data.Id}}" [title]="cell.text">{{cell.text}}</span>
                        </div>

                        <div *dxTemplate="let data of 'CashflowCategoryNameTemplate'">
                            <span [ngClass]="{'uncategorized': !data.value}">
                                <span class="clipboard-holder clickable-item"> {{ data.text }} </span>
                            </span>
                        </div>

                        <div *dxTemplate="let data of 'CashFlowTypeNameTemplate'" [class]="'clipboard-holder ' + data?.value?.toLowerCase()">
                            {{data.value}}
                        </div>

                        <div *dxTemplate="let data of 'startBalanceTotal'">
                            <div class="informer starting-balance">
                                <h2 class="count clipboard-holder">
                                    {{adjustmentStartingBalanceTotal  | currency:cfoPreferencesService.selectedCurrencyId:cfoPreferencesService.selectedCurrencySymbol:'1.2-2'}}
                                </h2>
                                <span class="name">{{l('Starting_Balance')}}</span>
                            </div>
                        </div>

                        <div *dxTemplate="let data of 'creditTotal'">
                            <div class="informer">
                                <h2 class="count positive-values clipboard-holder">
                                    {{ creditTransactionTotal | currency:cfoPreferencesService.selectedCurrencyId:cfoPreferencesService.selectedCurrencySymbol:'1.2-2' }}
                                </h2>
                                <span class="name" (click)="toggleCreditDefault()">
                                    {{l('Credits')}} <span class="name-count clipboard-holder">{{creditTransactionCount | number}}</span> <i id="creditDetails" class="arrow"></i>
                                </span>

                                <dx-tooltip target="#creditDetails"
                                            [(visible)]="defaultCreditTooltipVisible">
                                    <div *dxTemplate="let data = data of 'content'">
                                        <div class="tooltip-wrap classification-status">
                                            <header>
                                                {{l('Classification_Status')}}
                                                <span class="click-to-filter">{{l('ClickToFilter')}}</span>
                                            </header>
                                            <ul class="classification-list">

                                                <li class="classification-item classified" (click)="applyTotalFilters(true, true, false)">
                                                    <span class="classified-item-title"><span class="border">{{l('Classified')}}</span></span>
                                                    <span class="classification-item-number">{{creditClassifiedTransactionCount | number}}</span>
                                                    <span class="classification-item-percent">{{creditClassifiedTransactionCount / creditTransactionCount | percent}}</span>
                                                </li>
                                                <li class="classification-item unclassified" (click)="applyTotalFilters(false, true, false)">
                                                    <span class="unclassified-item-title"><span class="border">{{l('Unclassified')}}</span></span>
                                                    <span class="classification-item-number">{{creditTransactionCount - creditClassifiedTransactionCount}}</span>
                                                    <span class="classification-item-percent">{{(creditTransactionCount - creditClassifiedTransactionCount) / creditTransactionCount | percent}}</span>
                                                </li>
                                            </ul>
                                            <div class="btns-wrap clearfix" *ngIf="isInstanceAdmin">
                                                <a (click)="openDialog('credit');" class="small-button btn-layout">
                                                    {{l('Unclassify_Btn')}}
                                                </a>
                                                <a (click)="autoClassify('credit');" class="small-button btn-layout">
                                                    {{l('Auto_Classify_Btn')}}
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </dx-tooltip>
                            </div>
                        </div>

                        <div *dxTemplate="let data of 'debitTotal'">
                            <div class="informer">
                                <h2 class="count negative-values clipboard-holder">
                                    {{ debitTransactionTotal | currency:cfoPreferencesService.selectedCurrencyId:cfoPreferencesService.selectedCurrencySymbol:'1.2-2' }}
                                </h2>
                                <span class="name" (click)="toggleDebitDefault()">
                                    {{l('Debits')}} <span class="name-count clipboard-holder">{{debitTransactionCount | number}}</span> <i id="debitDetails" class="arrow"></i>
                                </span>
                                <dx-tooltip target="#debitDetails"
                                            [(visible)]="defaultDebitTooltipVisible">
                                    <div *dxTemplate="let data = data of 'content'">
                                        <div class="tooltip-wrap classification-status">
                                            <header>
                                                {{l('Classification_Status')}}
                                                <span class="click-to-filter">{{l('ClickToFilter')}}</span>
                                            </header>
                                            <ul class="classification-list">
                                                <li class="classification-item classified" (click)="applyTotalFilters(true, false, true)">
                                                    <span class="classified-item-title"><span class="border">{{l('Classified')}}</span></span>
                                                    <span class="classification-item-number">{{debitClassifiedTransactionCount | number}}</span>
                                                    <span class="classification-item-percent">{{debitClassifiedTransactionCount / debitTransactionCount | percent}}</span>
                                                </li>
                                                <li class="classification-item unclassified" (click)="applyTotalFilters(false, false, true)">
                                                    <span class="unclassified-item-title"><span class="border">{{l('Unclassified')}}</span></span>
                                                    <span class="classification-item-number">{{debitTransactionCount - debitClassifiedTransactionCount}}</span>
                                                    <span class="classification-item-percent">{{(debitTransactionCount - debitClassifiedTransactionCount) / debitTransactionCount | percent}}</span>
                                                </li>
                                            </ul>
                                            <div class="btns-wrap clearfix" *ngIf="isInstanceAdmin">
                                                <a (click)="openDialog('debit');" class="small-button btn-layout">
                                                    {{l('Unclassify_Btn')}}
                                                </a>
                                                <a (click)="autoClassify('debit');" class="small-button btn-layout">
                                                    {{l('Auto_Classify_Btn')}}
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </dx-tooltip>
                            </div>
                        </div>

                        <div *dxTemplate="let data of 'transactionTotal'">
                            <div class="informer">
                                <dx-tooltip target="#adjustments"
                                            position="top"
                                            (onContentReady)="changeDetectionRef.detectChanges()"
                                            showEvent="mouseenter"
                                            hideEvent="dxhoverend">
                                    <div *dxTemplate="let data of 'content'">
                                        <span class="title">{{ls('Platform', 'Unreconciled_Balance')}}:</span> {{adjustmentTotal | currency:cfoPreferencesService.selectedCurrencyId:cfoPreferencesService.selectedCurrencySymbol:'1.2-2'}}
                                    </div>
                                </dx-tooltip>
                                <dx-tooltip target="#totalDetails"
                                            [(visible)]="defaultTotalTooltipVisible">
                                    <div *dxTemplate="let data = data of 'content'">
                                        <div class="tooltip-wrap classification-status">
                                            <header>
                                                {{l('Classification_Status')}}
                                                <span class="click-to-filter">{{l('ClickToFilter')}}</span>
                                            </header>
                                            <ul class="classification-list">
                                                <li class="classification-item classified" (click)="applyTotalFilters(true, false, false)">
                                                    <span class="classified-item-title"><span class="border">{{l('Classified')}}</span></span>
                                                    <span class="classification-item-number">{{debitClassifiedTransactionCount + creditClassifiedTransactionCount | number}}</span>
                                                    <span class="classification-item-percent">{{(debitClassifiedTransactionCount + creditClassifiedTransactionCount) / transactionCount | percent}}</span>
                                                </li>
                                                <li class="classification-item unclassified" (click)="applyTotalFilters(false, false, false)">
                                                    <span class="unclassified-item-title"><span class="border">{{l('Unclassified')}}</span></span>
                                                    <span class="classification-item-number">{{transactionCount - (debitClassifiedTransactionCount + creditClassifiedTransactionCount)}}</span>
                                                    <span class="classification-item-percent">{{(transactionCount - (debitClassifiedTransactionCount + creditClassifiedTransactionCount)) / transactionCount | percent}}</span>
                                                </li>
                                            </ul>
                                            <div class="btns-wrap clearfix" *ngIf="isInstanceAdmin">
                                                <a (click)="openDialog('total');" class="small-button btn-layout">
                                                    {{l('Unclassify_Btn')}}
                                                </a>
                                                <a (click)="autoClassify('total');" class="small-button btn-layout">
                                                    {{l('Auto_Classify_Btn')}}
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </dx-tooltip>
                                <h2 class="count clipboard-holder">
                                    {{ transactionTotal | currency:cfoPreferencesService.selectedCurrencyId:cfoPreferencesService.selectedCurrencySymbol:'1.2-2' }}
                                </h2>
                                <span class="name" (click)="toggleTotalDefault()">
                                    <span id="adjustments" *ngIf="adjustmentTotal !== 0">!</span> {{l('Net_Amount')}} <span class="name-count clipboard-holder">{{transactionCount | number}}</span> <i id="totalDetails" class="arrow"></i>
                                </span>
                            </div>
                        </div>

                        <dxo-summary>
                            <dxi-group-item [column]="transactionFields.Id"
                                            summaryType="count"
                                            [displayFormat]="'{0} ' + l('Transactions').toLocaleLowerCase()">
                            </dxi-group-item>
                            <dxi-group-item [column]="transactionFields.Amount"
                                            summaryType="sum"
                                            [customizeText]="customizeGroupAmountCell"
                                            [alignByColumn]="true"
                                            displayFormat="Total: {0}">
                            </dxi-group-item>
                        </dxo-summary>
                    </dx-data-grid>
                </div>
            </div>
        </div>
    </div>
</div>
