<modal-dialog
    [title]="ls.l('Merge records')"
    [titleClearButton]="false"
    [buttons]="buttons"
    [editTitle]="false">
    <div class="form-content">
        <div class="header">
            <div class="fields">
                <span></span>
            </div>
            <div class="result">
                <div class="photo-area" [ngStyle]="{ 'background-image': 'url(' + profileService.getContactPhotoUrl(getResultPhotoId()) + ')' }"></div>
                <div class="name-wrapper">
                    <span [title]="getResultFullName()" [ngClass]="{nowrap: !!mergeInfo?.targetContactInfo?.companyName}">{{getResultFullName()}}</span>
                    <i [title]="mergeInfo?.targetContactInfo?.companyName || mergeInfo?.contactInfo?.companyName">
                        {{mergeInfo?.targetContactInfo?.companyName || mergeInfo?.contactInfo?.companyName}}
                    </i>
                    <i [title]="mergeInfo?.targetContactInfo?.companyName ? mergeInfo?.targetContactInfo?.jobTitle : mergeInfo?.contactInfo?.jobTitle">
                        {{mergeInfo?.targetContactInfo?.companyName ? mergeInfo?.targetContactInfo?.jobTitle : mergeInfo?.contactInfo?.jobTitle}}
                    </i>
                </div>
                <p>{{ls.l('FinalRecordView')}}</p>
            </div>
            <div class="target">
                <div class="photo-area" [ngStyle]="{ 'background-image': 'url(' + profileService.getContactPhotoUrl(mergeInfo?.targetContactInfo?.photoPublicId) + ')' }"></div>
                <div class="name-wrapper">
                    <span [title]="mergeInfo?.targetContactInfo?.fullName" [ngClass]="{nowrap: !!mergeInfo?.targetContactInfo?.companyName}">{{mergeInfo?.targetContactInfo?.fullName}}</span>
                    <i [title]="mergeInfo?.targetContactInfo?.companyName">{{mergeInfo?.targetContactInfo?.companyName}}</i>
                    <i [title]="mergeInfo?.targetContactInfo?.jobTitle">{{mergeInfo?.targetContactInfo?.jobTitle}}</i>
                </div>
                <p>{{ls.l('MainRecordUpdate')}}</p>
            </div>
            <div class="source">
                <div class="photo-area" [ngStyle]="{ 'background-image': 'url(' + profileService.getContactPhotoUrl(mergeInfo?.contactInfo?.photoPublicId) + ')' }"></div>
                <div class="name-wrapper">
                    <span [title]="mergeInfo?.contactInfo?.fullName" [ngClass]="{nowrap: !!mergeInfo?.contactInfo?.companyName}">{{mergeInfo?.contactInfo?.fullName}}</span>
                    <i [title]="mergeInfo?.contactInfo?.companyName">{{mergeInfo?.contactInfo?.companyName}}</i>
                    <i [title]="mergeInfo?.contactInfo?.jobTitle">{{mergeInfo?.contactInfo?.jobTitle}}</i>
                </div>
                <p>{{ls.l('DuplicateRecordDelete')}}</p>
            </div>
        </div>
        <dx-scroll-view showScrollbar="onHover" [height]="'calc(100vh - 180px)'">
            <div class="table-view">
                <ng-container *ngFor="let field of fields">
                    <div *ngIf="!field.hidden" [class]="'contact-field ' + field.name">
                        <div class="fields">
                            <p>{{field.caption}}</p>
                            <p *ngIf="field.result.values.length > 1" [class]="field.name">{{field.alt}}</p>
                        </div>
                        <ng-container *ngFor="let column of [COLUMN_RESULT_FIELD, COLUMN_TARGET_FIELD, COLUMN_SOURCE_FIELD]">
                            <div class="{{column}}">
                                <div *ngFor="let value of field[column].values; let i = index" class="field-wrapper">
                                    <p *ngIf="field.disabled" [title]="value.text">
                                        <i *ngIf="field.name == LEAD_STAGE_FIELD" [ngStyle]="{'background-color': getStageColorByName(value.text)}"></i>{{value.text}}
                                    </p>
                                    <dx-check-box
                                        [hint]="value.text"
                                        [text]="value.text"
                                        [class]="field.name + (i ? ' wrap' : '')"
                                        [(value)]="value.selected"
                                        [disabled]="value.disabled"
                                        [visible]="!field.disabled && (!value.isHidden || !value.isHidden())"
                                        [ngClass]="{ primary: value.isPrimary }"
                                        (click)="onSelectChange(field, value)">
                                    </dx-check-box>
                                    <span *ngIf="column == 'result' && value.id && !value.isPrimary" [title]="ls.l('SetAsPrimary')" class="set-primary" (click)="setAsPrimary(field, value)"></span>        
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </ng-container>
            </div>
        </dx-scroll-view>
    </div>
</modal-dialog>