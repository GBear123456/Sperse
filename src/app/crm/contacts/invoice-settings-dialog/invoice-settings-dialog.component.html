<modal-dialog [title]="ls.l('Invoice Settings')"
              [titleClearButton]="false"
              [buttons]="buttons"
              [editTitle]="false">
    <div class="form-content">
        <dx-scroll-view showScrollbar="onHover" #scrollView>
            <email-template-selector [(templateId)]="settings.defaultTemplateId"
                                     [templateType]="EmailTemplateType.Invoice"
                                     [showSystemDefault]="false"
                                     [title]="ls.l('InvoiceEmail_TemplateTitle')">
            </email-template-selector>
            <div class="row">
                <div class="settings-wrapper">
                    <div class="left-side">
                        <h3>{{ls.l('Company Info')}}</h3>
                        <dx-text-box [placeholder]="ls.l('LegalName')"
                                     [(value)]="settings.legalName"
                                     [readOnly]="isManageUnallowed"
                                     [maxLength]="150">
                        </dx-text-box>
                        <dx-text-box [readOnly]="isManageUnallowed"
                                     [placeholder]="ls.l('Tax/VatNo')"
                                     [(value)]="settings.taxVatNo"
                                     [maxLength]="20">
                        </dx-text-box>
                        <dx-text-area height="155px"
                                      [placeholder]="ls.l('Address')"
                                      [(value)]="settings.address"
                                      [readOnly]="isManageUnallowed"
                                      [maxLength]="500">
                        </dx-text-area>
                        <dx-text-area [readOnly]="isManageUnallowed"
                                      [placeholder]="ls.l('Invoice_DefaultNote')"
                                      [(value)]="settings.defaultNote">
                        </dx-text-area>
                    </div>
                    <div class="right-side">
                        <h3>{{ls.l('InvoiceEmail_OtherSettings')}}</h3>
                        <a (click)="showBankSettingsDialog()"
                           href="javascript:void(0)">
                            {{ls.l('InvoiceEmail_BankTransferSettings')}}
                        </a>
                        <dx-check-box [readOnly]="isManageUnallowed"
                                      [text]="ls.l('InvoiceEmail_ShowShippingAddress')"
                                      [(value)]="settings.showShippingAddress">
                        </dx-check-box>
                        <dx-check-box [readOnly]="isManageUnallowed"
                                      [text]="ls.l('InvoiceEmail_AttachPDF')"
                                      [(value)]="settings.attachPDF">
                        </dx-check-box>
                        <dx-number-box [min]="1"
                                        mode="number"
                                        [readOnly]="isManageUnallowed"
                                        [placeholder]="ls.l('InvoiceEmail_DueGracePeriod')"
                                        [(value)]="settings.dueGracePeriod"
                                        (onFocusOut)="onDueGracePeriodFocusOut($event)">
                            <dx-validator>
                                <dxi-validation-rule type="required"
                                                        [message]="ls.l('ThisFieldIsRequired')"></dxi-validation-rule>
                            </dx-validator>
                        </dx-number-box>
                        <ng-container *ngIf="hasBankCodeFeature">
                            <div class="field default-advisor">
                                <source-contact-list [selectedKey]="settings?.defaultAdvisorContactId"
                                                     [targetSelector]="'#affiliateContactLink'"
                                                     (onItemSelected)="onAdvisorContactChanged($event)">
                                </source-contact-list>
                                <label>{{ ls.l('DefaultAdvisorContact') }}:</label>
                                <div class="advisor-name">
                                    <span [ngClass]="{empty: !settings?.defaultAdvisorContactId}">
                                        {{ settings?.advisorName ? settings?.advisorName : (ls.l('Set') + ' ' + ls.l('DefaultAdvisorContact')) }}
                                        <i id="affiliateContactLink" class="edit fa fa-pencil"
                                           (click)="openAdvisorContactList($event)">
                                        </i>
                                        <ng-container *ngIf="settings?.defaultAdvisorContactId">
                                            <i class="remove fa fa-times"
                                               (click)="removeSourceContact($event)">
                                            </i>
                                        </ng-container>
                                    </span>
                                </div>
                            </div>
                        </ng-container>
                        <ng-container>
                            <dx-check-box [readOnly]="isManageUnallowed"
                                          [text]="ls.l('InvoiceEmail_DisableProlongingSubscriptionByQuantity')"
                                          [(value)]="settings.disableProlongingSubscriptionByQuantity">
                            </dx-check-box>
                        </ng-container>
                    </div>
                </div>
            </div>
        </dx-scroll-view>
    </div>
</modal-dialog>