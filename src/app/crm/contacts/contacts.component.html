<item-details-layout
    [navLinks]="navLinks"
    [queryParams]="queryParams"
    [rightPanelOpened]="false"
    (onClose)="close()"
    (onChanged)="updateContextType($event)">
    <ng-container topHeader>
        <details-header [data]="contactInfo"
                        [personContactInfo]="personContactInfo"
                        [ratingId]="ratingId"
                        (onInvalidate)="reloadCurrentSection($event)"
                        (onContactSelected)="onContactSelected($event)">
        </details-header>
    </ng-container>
    <ng-container underHeader>
        <div class="general-links">
            <a routerLink="user-inbox" routerLinkActive="general-active-link" [queryParams]="queryParams" [class.disabled]="!isCommunicationHistoryAllowed"><i class="inbox-icon" aria-hidden="true"></i></a>
            <i class="phone-icon" aria-hidden="true" [class.disabled]="true"></i>
            <a (click)="showSMSDialog()" [class.disabled]="!isSendSmsAndEmailAllowed"><i class="sms-icon"></i></a>
        </div>
        <operations-widget
            [enabled]="contactInfo && showToolbar"
            [customerType]="contactGroupId$ | async"
            [leadId]="leadId"
            [contactInfo]="contactInfo"
            [stages]="leadStages"
            [selectedStageId]="clientStageId"
            [partnerTypes]="partnerTypes"
            [selectedPartnerTypeId]="partnerTypeId"
            (print)="printMainArea()"
            (onUpdateStatus)="updateStatus($event)"
            (onUpdateRating)="updateRating($event)"
            (onDelete)="deleteLead()"
            (prev)="loadTargetEntity($event, targetDirections.Prev)"
            (next)="loadTargetEntity($event, targetDirections.Next)"
            [getProxyService]="getProxyService"
            [assignedUsersSelector]="assignedUsersSelector"
            [getAssignmentsPermissionKey]="getAssignmentsPermissionKey">
        </operations-widget>
    </ng-container>
    <ng-container aboveNavigation>
        <div class="short-contact" *ngIf="!isUserProfile">
            <div class="related-contacts">
                <div *ngIf="contactInfo && contactInfo['organizationContactInfo']?.contactPersons?.length > 1; else addNew" class="contact-persons-info" (click)="showContactPersons($event)">
                    <img src="./assets/common/icons/similar-contacts.svg" alt="Contact Persons">
                    <span class="similar-contacts-count">{{ contactInfo['organizationContactInfo']?.contactPersons.length - 1 }} related contact<span *ngIf="contactInfo['organizationContactInfo']?.contactPersons.length - 1 > 1">s</span></span>
                    <img src="./assets/common/icons/down-arrow-icon.svg" alt="Contact Persons">
                </div>

                <ng-template #addNew>
                    <div class="contact-persons-info" (click)="addNewContact($event)" *ngIf="contactInfo?.primaryOrganizationContactId && manageAllowed">
                        <img src="./assets/common/icons/similar-contacts.svg" alt="Contact Persons">
                        <a class="add-new-contact">{{l('AddRelatedContact')}}</a>
                    </div>
                </ng-template>
            </div>
        </div>
    </ng-container>
    <ng-container rightPanel>
    </ng-container>
</item-details-layout>
