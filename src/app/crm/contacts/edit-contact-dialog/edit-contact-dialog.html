<!-- Modern Contact Dialog UI -->
<div class="contact-dialog-container" (mousedown)="mouseDown($event)">
    <!-- Header Section -->
    <div class="dialog-header">
        <div class="header-content">
            <div class="icon-container">
                <div class="phone-icon" *ngIf="data.field === 'phoneNumber'">
                    <i class="fa fa-phone"></i>
                </div>
                <div class="envelope-icon" *ngIf="data.field === 'emailAddress'">
                    <i class="fa fa-envelope"></i>
                </div>
                <div class="link-icon" *ngIf="data.field === 'url'">
                    <i class="fa fa-link"></i>
                </div>
            </div>
            <div class="title-section">
                <h2 class="dialog-title">
                    <span *ngIf="data.field === 'phoneNumber'">{{action === 'Edit' ? 'Edit Phone' : 'Add Phone'}}</span>
                    <span *ngIf="data.field === 'emailAddress'">{{action === 'Edit' ? 'Edit Email' : 'Add Email'}}</span>
                    <span *ngIf="data.field === 'url'">{{action === 'Edit' ? 'Edit Link' : 'Add Link'}}</span>
                </h2>
                <p class="dialog-subtitle">
                    <span *ngIf="data.field === 'phoneNumber'">Add a new phone number</span>
                    <span *ngIf="data.field === 'emailAddress'">Add a new email address</span>
                    <span *ngIf="data.field === 'url'">Add a new link</span>
                </p>
            </div>
        </div>
        <div class="header-actions">
            <button mat-button mat-dialog-close class="cancel-btn">{{ls.l('Cancel')}}</button>
            <button *ngIf="isEditAllowed" mat-button class="save-btn" (click)="onSave()">
                {{action == 'Edit' ? ls.l('Update') : 'Save'}}
            </button>
        </div>
    </div>

    <!-- Content Section -->
    <div class="dialog-content">
        <dx-validation-group (onInitialized)="initValidationGroup($event)">
            
            <!-- Phone Type Selection Tabs (only for phone numbers) -->
            <div *ngIf="data.field === 'phoneNumber'" class="type-selection">
                <div class="type-tabs">
                    <div class="type-tab" 
                         [class.active]="getPhoneType() === 'Mobile'"
                         (click)="setPhoneType('Mobile')">
                        <i class="fa fa-tablet"></i>
                        <span>Mobile</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getPhoneType() === 'Home'"
                         (click)="setPhoneType('Home')">
                        <i class="fa fa-home"></i>
                        <span>Home</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getPhoneType() === 'Work'"
                         (click)="setPhoneType('Work')">
                        <i class="fa fa-briefcase"></i>
                        <span>Work</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getPhoneType() === 'Fax'"
                         (click)="setPhoneType('Fax')">
                        <i class="fa fa-fax"></i>
                        <span>Fax</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getPhoneType() === 'Other'"
                         (click)="setPhoneType('Other')">
                        <i class="fa fa-phone"></i>
                        <span>Other</span>
                    </div>
                </div>
            </div>

            <!-- Email Type Selection Tabs (only for email addresses) -->
            <div *ngIf="data.field === 'emailAddress'" class="type-selection">
                <div class="type-tabs">
                    <div class="type-tab" 
                         [class.active]="getEmailType() === 'Personal'"
                         (click)="setEmailType('Personal')">
                        <i class="fa fa-user"></i>
                        <span>Personal</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getEmailType() === 'Work'"
                         (click)="setEmailType('Work')">
                        <i class="fa fa-briefcase"></i>
                        <span>Work</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getEmailType() === 'Other'"
                         (click)="setEmailType('Other')">
                        <i class="fa fa-envelope"></i>
                        <span>Other</span>
                    </div>
                </div>
            </div>

            <!-- URL Field -->
            <div *ngIf="data.field == 'url'" class="field-group">
                <label class="field-label">{{ls.l('Link')}}</label>
                <dx-text-box
                    name="url"
                    [disabled]="!isEditAllowed"
                    [(value)]="data.url"
                    placeholder="Enter URL">
                    <dx-validator>
                        <dxi-validation-rule type="required" message="{{ls.l('LinkIsRequired')}}."></dxi-validation-rule>
                        <dxi-validation-rule type="pattern" [pattern]="urlRegEx" message="{{ls.l('LinkIsNotValid')}}."></dxi-validation-rule>
                    </dx-validator>
                </dx-text-box>
            </div>

            <!-- Email Address Field -->
            <div *ngIf="data.field == 'emailAddress'" class="field-group">
                <label class="field-label">Email address</label>
                <input
                    type="email"
                    name="email"
                    class="form-control"
                    [disabled]="!isEditAllowed"
                    [(ngModel)]="data.emailAddress"
                    placeholder="Enter email address"
                    required
                    [pattern]="emailRegEx">
            </div>

            <!-- Phone Number Field -->
            <div *ngIf="data.field == 'phoneNumber'" class="field-group">
                <label class="field-label">Phone number</label>
                <div class="phone-input-container">
                    <country-phone-number [(phoneNumber)]="data.phoneNumber" #countryPhoneNumber></country-phone-number>
                </div>
            </div>

            <!-- Phone Extension Field -->
            <div *ngIf="data.field == 'phoneNumber'" class="field-group">
                <label class="field-label">Extension (optional)</label>
                <input
                    type="text"
                    name="phoneExtension"
                    class="form-control extension-input"
                    [disabled]="!isEditAllowed"
                    [(ngModel)]="data.phoneExtension"
                    placeholder="Extension (optional)"
                    maxlength="5">
            </div>

            <!-- Comment/Note Field -->
            <div class="field-group comment-field">
                <label class="field-label">
                    <span *ngIf="data.field === 'phoneNumber'">Note about this phone number (optional)</span>
                    <span *ngIf="data.field === 'emailAddress'">Note about this email (optional)</span>
                    <span *ngIf="data.field === 'url'">{{ls.l('Comment')}}</span>
                </label>
                <textarea
                    name="comment"
                    class="form-control"
                    [disabled]="!isEditAllowed"
                    [(ngModel)]="data.comment"
                    [placeholder]="data.field === 'phoneNumber' ? 'Note about this phone number (optional)' : data.field === 'emailAddress' ? 'Add a note about this email' : 'Add a comment'"
                    rows="3">
                </textarea>
            </div>

            <!-- Status Checkboxes -->
            <div class="status-checkboxes">
                <div class="checkbox-item">
                    <dx-check-box
                        text="Active"
                        [disabled]="!isEditAllowed"
                        [(value)]="data.isActive">
                    </dx-check-box>
                </div>
                <div class="checkbox-item">
                    <dx-check-box
                        text="Confirmed"
                        [disabled]="!isEditAllowed"
                        [(value)]="data.isConfirmed">
                    </dx-check-box>
                </div>
            </div>

            <!-- Delete Button (for edit mode) -->
            <div *ngIf="isEditAllowed && (action=='Edit')" class="delete-section">
                <button mat-button class="delete-btn" (click)="data.deleteItem($event)">
                    <i class="fa fa-trash"></i>
                    {{ls.l('Delete')}}
                </button>
            </div>
        </dx-validation-group>
    </div>
</div>
