<!-- Modern Contact Dialog UI -->
<div class="contact-dialog-container" 
     [class.email-dialog]="data.field === 'emailAddress'"
     [class.phone-dialog]="data.field === 'phoneNumber'"
     [class.address-dialog]="data.field === 'url'"
     (mousedown)="mouseDown($event)">
    <!-- Header Section -->
    <div class="dialog-header">
        <div class="header-content">
            <div class="icon-container">
                <div class="phone-icon" *ngIf="data.field === 'phoneNumber'">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-phone h-6 w-6 sm:h-7 sm:w-7 text-green-600 dark:text-green-400" ><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                </div>
                <div class="envelope-icon" *ngIf="data.field === 'emailAddress'">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail h-6 w-6 sm:h-7 sm:w-7 text-blue-600 dark:text-blue-400" ><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg>
                </div>
                <div class="link-icon" *ngIf="data.field === 'url'">
                    <i class="fa fa-link"></i>
                </div>
            </div>
            <div class="title-section">
                <h2 class="dialog-title">
                    <span *ngIf="data.field === 'phoneNumber'">{{action === 'Edit' ? 'Edit Phone' : 'Add Phone'}}</span>
                    <span *ngIf="data.field === 'emailAddress'">{{action === 'Edit' ? 'Edit Email' : 'Add Email'}}</span>
                    <span *ngIf="data.field === 'url'">{{action === 'Edit' ? 'Edit Link' : 'Add Link'}}</span>
                </h2>
                <p class="dialog-subtitle">
                    <span *ngIf="data.field === 'phoneNumber'">Add a new phone number</span>
                    <span *ngIf="data.field === 'emailAddress'">Add a new email address</span>
                    <span *ngIf="data.field === 'url'">Add a new link</span>
                </p>
            </div>
        </div>
        <div class="header-actions">
            <button mat-button mat-dialog-close class="cancel-btn">{{ls.l('Cancel')}}</button>
            <button *ngIf="isEditAllowed" mat-button class="save-btn" (click)="onSave()">
                {{action == 'Edit' ? ls.l('Update') : 'Save'}}
            </button>
        </div>
    </div>

    <!-- Content Section -->
    <div class="dialog-content">
        <dx-validation-group (onInitialized)="initValidationGroup($event)">
            
            <!-- Phone Type Selection Tabs (only for phone numbers) -->
            <div *ngIf="data.field === 'phoneNumber'" class="type-selection">
                <div class="type-tabs">
                    <div class="type-tab" 
                         [class.active]="getPhoneType() === 'Mobile'"
                         (click)="setPhoneType('Mobile')">
                        <i class="fa fa-tablet"></i>
                        <span>Mobile</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getPhoneType() === 'Home'"
                         (click)="setPhoneType('Home')">
                        <i class="fa fa-home"></i>
                        <span>Home</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getPhoneType() === 'Work'"
                         (click)="setPhoneType('Work')">
                        <i class="fa fa-briefcase"></i>
                        <span>Work</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getPhoneType() === 'Fax'"
                         (click)="setPhoneType('Fax')">
                        <i class="fa fa-fax"></i>
                        <span>Fax</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getPhoneType() === 'Other'"
                         (click)="setPhoneType('Other')">
                        <i class="fa fa-phone"></i>
                        <span>Other</span>
                    </div>
                </div>
            </div>

            <!-- Email Type Selection Tabs (only for email addresses) -->
            <div *ngIf="data.field === 'emailAddress'" class="type-selection">
                <div class="type-tabs">
                    <div class="type-tab" 
                         [class.active]="getEmailType() === 'Personal'"
                         (click)="setEmailType('Personal')">
                         <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                        <span>Personal</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getEmailType() === 'Work'"
                         (click)="setEmailType('Work')">
                         <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><path d="M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path><rect width="20" height="14" x="2" y="6" rx="2"></rect></svg>
                        <span>Work</span>
                    </div>
                    <div class="type-tab" 
                         [class.active]="getEmailType() === 'Other'"
                         (click)="setEmailType('Other')">
                         <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg>
                        <span>Other</span>
                    </div>
                </div>
            </div>

            <!-- URL Field -->
            <div *ngIf="data.field == 'url'" class="field-group">
                <label class="field-label">{{ls.l('Link')}}</label>
                <dx-text-box
                    name="url"
                    [disabled]="!isEditAllowed"
                    [(value)]="data.url"
                    placeholder="Enter URL">
                    <dx-validator>
                        <dxi-validation-rule type="required" message="{{ls.l('LinkIsRequired')}}."></dxi-validation-rule>
                        <dxi-validation-rule type="pattern" [pattern]="urlRegEx" message="{{ls.l('LinkIsNotValid')}}."></dxi-validation-rule>
                    </dx-validator>
                </dx-text-box>
            </div>

            <!-- Email Address Field -->
            <div *ngIf="data.field == 'emailAddress'" class="field-group">
                <label class="field-label">Email address</label>
                <input
                    type="email"
                    name="email"
                    class="form-control"
                    [disabled]="!isEditAllowed"
                    [(ngModel)]="data.emailAddress"
                    placeholder="Email address"
                    required
                    [pattern]="emailRegEx">
            </div>

            <!-- Phone Number Field -->
            <div *ngIf="data.field == 'phoneNumber'" class="field-group">
                <label class="field-label">Phone number</label>
                <div class="phone-input-container">
                    <country-phone-number [(phoneNumber)]="data.phoneNumber" #countryPhoneNumber></country-phone-number>
                </div>
            </div>

            <!-- Phone Extension Field -->
            <div *ngIf="data.field == 'phoneNumber'" class="field-group">
                <label class="field-label">Extension (optional)</label>
                <input
                    type="text"
                    name="phoneExtension"
                    class="form-control extension-input"
                    [disabled]="!isEditAllowed"
                    [(ngModel)]="data.phoneExtension"
                    placeholder="Extension (optional)"
                    maxlength="5">
            </div>

            <!-- Comment/Note Field -->
            <div class="field-group comment-field">
                <label class="field-label">
                    <span *ngIf="data.field === 'phoneNumber'">Note about this phone number (optional)</span>
                    <span *ngIf="data.field === 'emailAddress'">Note about this email (optional)</span>
                    <span *ngIf="data.field === 'url'">{{ls.l('Comment')}}</span>
                </label>
                <textarea
                    name="comment"
                    class="form-control"
                    [disabled]="!isEditAllowed"
                    [(ngModel)]="data.comment"
                    [placeholder]="data.field === 'phoneNumber' ? 'Note about this phone number (optional)' : data.field === 'emailAddress' ? 'Add a note about this email' : 'Add a comment'"
                    rows="3">
                </textarea>
            </div>

            <!-- Status Checkboxes -->
            <div class="status-checkboxes">
                <div class="checkbox-item">
                    <dx-check-box
                        text="Active"
                        [disabled]="!isEditAllowed"
                        [(value)]="data.isActive">
                    </dx-check-box>
                </div>
                <div class="checkbox-item">
                    <dx-check-box
                        text="Confirmed"
                        [disabled]="!isEditAllowed"
                        [(value)]="data.isConfirmed">
                    </dx-check-box>
                </div>
            </div>

            <!-- Delete Button (for edit mode) -->
            <div *ngIf="isEditAllowed && (action=='Edit')" class="delete-section">
                <button type="button" class="delete-btn" (click)="data.deleteItem($event)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash2 h-4 w-4 mr-2" ><path d="M3 6h18"></path><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path><line x1="10" x2="10" y1="11" y2="17"></line><line x1="14" x2="14" y1="11" y2="17"></line></svg>
                    {{ls.l('Delete')}}
                </button>
            </div>
        </dx-validation-group>
    </div>
</div>
