<source-contact-list
    [leadId]="leadInfo?.id"
    [selectedKey]="leadInfo?.sourceContactId"
    (onDataLoaded)="onSourceContactLoaded($event)">
</source-contact-list>
<h2 mat-dialog-title>{{ls.l('Personal Settings')}}<span class="close" (click)="close()"></span></h2>
<mat-dialog-content>
    <mat-tab-group>
        <mat-tab [label]="ls.l('General')">
            <dx-scroll-view showScrollbar="onHover" [height]="getTabContentHeight()">
                <div class="general-tab">
                    <div>
                        <div class="affiliate-title"><h3>{{ ls.l('AffiliateInfo') }}</h3><h4>{{ ls.l('AffiliateCode') }}</h4></div>
                        <div class="affiliate-field">
                            <inplace-edit [id]="contactInfo.id"
                                          lEntityName="Name"
                                          [editPlaceholder]="ls.l('Affiliate')"
                                          [value]="affiliateCode$ | async"
                                          [showInlineEditButton]="true"
                                          [isDeleteEnabled]="true"
                                          [lDeleteConfirmTitle]="ls.l('DeleteContactHeader', ls.l('AffiliateCode'))"
                                          [lDeleteConfirmMessage]="ls.l('DeleteContactMessage', ls.l('AffiliateCode').toLowerCase())"
                                          [validationRules]="affiliateValidationRules"
                                          [isReadOnlyField]="!permissionChecker.checkCGPermission(contactInfo.groupId)"
                                          (valueChanged)="updateAffiliateCode($event)"
                                          (itemDeleted)="deleteItem(ls.l('Affiliate'))">
                            </inplace-edit>
                        </div>
                    </div>
                    <div>
                        <h3>{{ ls.l('SourceInfo') }}</h3>
                        <div class="field">
                            <label>{{ ls.l('ReferralPartner') }}:</label>
                            <span>{{sourceContactName}}<i *ngIf="sourceContactName" class="save-to-clipboard" (click)="saveToClipboard(sourceContactName)"></i></span>
                        </div>
                        <hr>
                        <div class="field">
                            <label>{{ ls.l('AssignedToRM') }}:</label>
                            <span>{{contactInfo?.assignedUserName}}<i *ngIf="contactInfo?.assignedUserName" class="save-to-clipboard" (click)="saveToClipboard(contactInfo?.assignedUserName)"></i></span>
                        </div>
                        <hr>
                        <div class="field">
                            <label>{{ ls.l('CreatedBy') }}:</label>
                            <span>{{contactInfo?.creatorUserName}}<i *ngIf="contactInfo?.creatorUserName" class="save-to-clipboard" (click)="saveToClipboard(contactInfo?.creatorUserName)"></i></span>
                            <p class="channel-code">{{leadInfo?.channelCode}}</p><p>on {{contactInfo?.contactDate | date: formatting.dateTime : userTimezone}}</p>
                        </div>
                        <hr>
                        <div class="field">
                            <label>{{ ls.l('LastUpdatedBy') }}:</label>
                            <span>{{contactInfo?.lastModifierUserName}}<i *ngIf="contactInfo?.lastModifierUserName" class="save-to-clipboard" (click)="saveToClipboard(contactInfo?.lastModifierUserName)"></i></span>
                            <p class="date-ago">({{contactInfo?.lastModificationTime | timeAgo}})</p><p>on {{contactInfo?.lastModificationTime | date: formatting.dateTime : userTimezone}}</p>
                        </div>
                        <div class="field">
                            <label>{{ ls.l('ContactID') }}:</label>
                            <span>{{contactInfo?.id}}<i class="save-to-clipboard" (click)="saveToClipboard(contactInfo?.id)"></i></span>
                        </div>
                        <div class="field">                        
                            <label>{{ ls.l('RecentLeadID') }}:</label>
                            <span>{{leadInfo?.id}}<i class="save-to-clipboard" (click)="saveToClipboard(leadInfo?.id)"></i></span>
                        </div>
                        <div class="field">
                            <label>{{ ls.l('Xref') }}:</label>
                            <inplace-edit [id]="contactInfo.id"
                                          lEntityName="Name"
                                          [editPlaceholder]="ls.l('Xref')"
                                          [value]="contactXref$ | async"
                                          [isOptional]="true"
                                          [showInlineEditButton]="true"
                                          [isDeleteEnabled]="true"
                                          [lDeleteConfirmTitle]="ls.l('DeleteContactHeader', ls.l('Xref'))"
                                          [lDeleteConfirmMessage]="ls.l('DeleteContactMessage', ls.l('Xref').toLowerCase())"
                                          [validationRules]="xrefValidationRules"
                                          [isReadOnlyField]="!permissionChecker.checkCGPermission(contactInfo.groupId)"
                                          (valueChanged)="updateXref($event)"
                                          (itemDeleted)="deleteItem(ls.l('Xref'))">
                            </inplace-edit>
                        </div>
                        <ng-container *ngFor="let n of [1,2,3,4,5]">
                            <div class="field" *ngIf="isLayoutTypeBankCode || contactInfo?.personContactInfo['customField' + n] as value">
                                <label>{{ ls.l('Contact_CustomField' + n) }}</label>
                                <span>{{ value }}<i class="save-to-clipboard" (click)="saveToClipboard(value)"></i></span>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </dx-scroll-view>
        </mat-tab>
        <mat-tab [label]="ls.l('Overview')" *ngIf="showOverviewTab">
            <span class="gear-icon" (click)="toggleConfigMode()"></span>
            <dx-scroll-view showScrollbar="onHover">
                <div class="overview-content" [ngClass]="{'config-mode': configMode}">
                    <div class="right-panel-block" [hidden]="!configMode && !overviewPanelSetting?.clientScores">
                        <input *ngIf="configMode" type="checkbox"
                               (click)="toggleSectionVisibility($event, 'clientScores')"
                               class="cb-visible-section" [checked]="overviewPanelSetting?.clientScores">
                        <client-scores></client-scores>
                    </div>
                    <div class="right-panel-block" [hidden]="!configMode && !overviewPanelSetting?.totalApproved">
                        <input *ngIf="configMode" type="checkbox"
                               (click)="toggleSectionVisibility($event, 'totalApproved')"
                               class="cb-visible-section" [checked]="overviewPanelSetting?.totalApproved">
                        <total-approved></total-approved>
                    </div>
                    <!-- credit-lines></credit-lines -->
                    <div class="right-panel-block" [hidden]="!configMode && !overviewPanelSetting?.verification">
                        <input *ngIf="configMode" type="checkbox"
                               (click)="toggleSectionVisibility($event, 'verification')"
                               class="cb-visible-section" [checked]="overviewPanelSetting?.verification">
                        <verification-checklist [data]="verificationChecklist"></verification-checklist>
                    </div>
                    <!-- required-documents></required-documents -->
                </div>
            </dx-scroll-view>
        </mat-tab>
        <mat-tab label="Activity" [disabled]="true">
            Activity
        </mat-tab>
    </mat-tab-group>
</mat-dialog-content>