<modal-dialog [title]="data.title"
              [titleClearButton]="false"
              [buttons]="buttons"
              [editTitle]="false">
    <ng-container headerContent>
        <dx-select-box
            name="template"
            width="250px"
            height="40px"
            displayExpr="name"
            valueExpr="id"
            [placeholder]="ls.l('Template')"
            [(value)]="data.templateId"
            [dataSource]="templates$ | async"
            [acceptCustomValue]="templateEditMode"
            (onCustomItemCreating)="onNewTemplate($event)"
            (onValueChanged)="onTemplateChanged($event)">
        </dx-select-box>
    </ng-container>

    <div class="form-content">
        <dx-scroll-view showScrollbar="onHover">
            <div class="row">
                <div class="field-area">
                    <dx-tag-box
                        name="from"
                        width="100%"
                        height="40px"
                        noDataText=""
                        [multiline]="false"
                        [acceptCustomValue]="true"
                        [placeholder]="ls.l('From')"
                        [(value)]="data.emailFrom"
                        [visible]="!templateEditMode"
                        (onOpened)="emailInputFocusIn($event)"
                        (onCustomItemCreating)="onCustomItemCreating($event)">
                    </dx-tag-box>
                </div>
                <div class="field-area">
                    <dx-tag-box
                        name="to"
                        width="100%"
                        height="40px"
                        noDataText=""
                        [multiline]="false"
                        [acceptCustomValue]="true"
                        [placeholder]="ls.l('To')"
                        [(value)]="data.emailTo"
                        [disabled]="data.templateType"
                        (onOpened)="emailInputFocusIn($event)"
                        (onCustomItemCreating)="onCustomItemCreating($event)">
                    </dx-tag-box>
                    <div class="bcc-links">
                        <span (click)="showInputField(CCElement)" [hidden]="showCC">{{ls.l('CC')}}</span>
                        <span (click)="showInputField(BCCElement)" [hidden]="showBCC">{{ls.l('BCC')}}</span>
                    </div>
                </div>
                <div class="field-area">
                    <dx-tag-box #CCElement
                        name="showCC"
                        width="100%"
                        height="40px"
                        [visible]="showCC"
                        noDataText=""
                        [multiline]="false"
                        [acceptCustomValue]="true"
                        [placeholder]="ls.l('CC')"
                        [(value)]="data.cc"
                        (onOpened)="emailInputFocusIn($event)"
                        (onFocusOut)="emailInputFocusOut($event)"
                        (onCustomItemCreating)="onCustomItemCreating($event)">
                    </dx-tag-box>
                </div>
                <div class="field-area">
                    <dx-tag-box #BCCElement
                        name="showBCC"
                        width="100%"
                        height="40px"
                        [visible]="showBCC"
                        noDataText=""
                        [multiline]="false"
                        [acceptCustomValue]="true"
                        [placeholder]="ls.l('BCC')"                        
                        [(value)]="data.bcc"
                        (onOpened)="emailInputFocusIn($event)"
                        (onFocusOut)="emailInputFocusOut($event)"
                        (onCustomItemCreating)="onCustomItemCreating($event)">
                    </dx-tag-box>
                </div>
                <div class="field-area">
                    <dx-text-box
                        name="subject"
                        width="100%"
                        height="40px"
                        [placeholder]="ls.l('Subject')"
                        [(value)]="data.subject">
                    </dx-text-box>
                </div>
                <div class="field-area">
                    <ckeditor #ckeditor [editor]="EditorClass" [data]="data.body" (change)="onBodyChange($event)"></ckeditor>
                </div>
                <ng-content *ngIf="data.templateType" select="[templateSettings]"></ng-content>
            </div>
        </dx-scroll-view>
    </div>
</modal-dialog>