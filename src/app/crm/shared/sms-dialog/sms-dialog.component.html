<modal-dialog [title]="ls.l('NewSms')"
    [buttons]="buttons"
    [editTitle]="false"
    [isTitleValid]="true"
    [titleClearButton]="false">
    <dx-tooltip #tags
        width="200px"
        height="150px"
        target="#insertTag"
        [disabled]="false"        
        showEvent="dxhoverstart">
        <div *dxTemplate="let data of 'content'">
            <dx-list 
                [dataSource]="tagNames"
                (onItemClick)="insertTag($event, textArea, tags)">
                <div *dxTemplate="let item of 'item'">
                    <span>{{ls.l(item)}}</span>
                </div>
            </dx-list>
        </div>
    </dx-tooltip>

    <dx-validation-group>
        <div class="field">
            <label class="to">{{ ls.l('To') }}</label>
            <dx-select-box
                name="phoneNumber"
                [placeholder]="ls.l('TypeNumber')"
                [acceptCustomValue]="true"
                [dataSource]="phones"
                [(value)]="phoneNumber"
                fieldTemplate="phoneTemplate"
                itemTemplate="phoneItemTemplate">
                <div *dxTemplate="let item of 'phoneTemplate'">
                    <div class="phone-wrapper">
                        <dx-text-box [value]="phoneFormatPipe.transform(item)"></dx-text-box>
                        <country-phone-number [(phoneNumber)]="phoneNumber"
                                              (click)="phoneNumberClick($event)">
                        </country-phone-number>
                    </div>
                </div>
                <div *dxTemplate="let item of 'phoneItemTemplate'">
                    <div class="phone-item-wrapper">
                        <span>{{phoneFormatPipe.transform(item)}}</span>
                    </div>
                </div>
                <dx-validator>
                    <dxi-validation-rule type="required" [message]="ls.l('PhoneIsRequired')"></dxi-validation-rule>
                </dx-validator>
            </dx-select-box>
        </div>
        <div class="text-area field">
            <label class="message">{{ ls.l('Message') }}</label>
            <dx-text-area #textArea
                height="200px"
                [placeholder]="ls.l('TypeYourMessage')"
                valueChangeEvent="keyup"
                [maxLength]="smsMaxLength"
                [(value)]="smsText">
                <dx-validator>
                    <dxi-validation-rule type="required" [message]="ls.l('MessageIsRequired')"></dxi-validation-rule>
                </dx-validator>
            </dx-text-area>
            <div class="footer-wrapper">
                <div class="number-of-symbols">{{ (smsMaxLength - smsText?.length) + ' ' + ls.l('CharactersLeft') }}</div><a id="insertTag" (mouseover)="tags.instance.option('visible', true)">{{ls.l('InsertTag')}}</a>
            </div>
        </div>
    </dx-validation-group>
    <bank-code-decode [content]="smsText" [source]="'CRMSMS'" (onDecodeStart)="startLoading()" (onDecodeFinish)="finishLoading()"></bank-code-decode>
</modal-dialog>