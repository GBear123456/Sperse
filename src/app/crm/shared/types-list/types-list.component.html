<dx-tooltip height="410"
            [target]="targetSelector"
            [(visible)]="tooltipVisible">
    <div *dxTemplate="let data of 'content'">
        <div class="tags-tooltip-container">
            <div class="actions clearfix">
                <span class="title">{{l('Types')}}</span>
                <div [hidden]="hideButtons || bulkUpdateMode">
                    <span class="filter-clear" [class.disabled]="!checkPermissions()" (click)="clear()">{{l('Clear')}}</span>
                    <span class="filter-apply" [class.disabled]="!checkPermissions()" (click)="apply()">{{l('Apply')}}</span>
                </div>
                <div [hidden]="hideButtons || !bulkUpdateMode || !selectedKeys?.length">
                    <span class="filter-clear" [class.disabled]="!checkPermissions()" (click)="apply(true)">{{l('Remove')}}</span>
                    <span class="filter-apply" [class.disabled]="!checkPermissions() || !typeslist.selectedRowKeys?.length" (click)="apply()">{{l('Add')}}</span>
                </div>
            </div>
            <dx-tree-list #typeslist
                          width="300px"
                          height="350px"
                          keyExpr="id"
                          parentIdExpr="parent"
                          [rootValue]="0"
                          [noDataText]="l('AddNewTag')"
                          [showColumnLines]="false"
                          [showColumnHeaders]="false"
                          [searchPanel]="{visible: true, placeholder: l('Search'), width: 260}"
                          [selection]="{ allowSelectAll: false, mode: 'single' }"
                          [selectedRowKeys]="selectedTypes"
                          [(dataSource)]="list"
                          (onRowClick)="onRowClick($event)"
                          (onInitialized)="onInitialized($event)"
                          (onInitNewRow)="onInitNewRow($event)"
                          (onRowRemoving)="onRowRemoving($event)"
                          (onRowUpdating)="onRowUpdating($event)"
                          (onRowInserting)="onRowInserting($event)"
                          (onSelectionChanged)="onSelectionChanged($event)"
                          (onCellPrepared)="onCellPrepared($event)"
                          (onContentReady)="onContentReady($event)"
                          (onRowInserted)="onRowInserted($event)"
                          (onEditorPrepared)="editorPrepared($event)"
                          [ngClass]="(!bulkUpdateMode || selectedKeys?.length) ? 'add-new-item-mode' : ''">
                <dxi-column cellTemplate="radiogroup" width="50px" allowEditing="false" [visible]="selectedKeys && selectedKeys.length"
                    allowFiltering="false" allowFixing="true" allowHeaderFiltering="false" allowHiding="false" 
                    allowReordering="false" allowResizing="false" allowSearch="false" allowSorting="false"></dxi-column>
                <dxi-column dataField="name" [sortingMethod]="customSortingMethod" [sortIndex]="0" sortOrder="asc"></dxi-column>

                <div *dxTemplate="let cellData of 'radiogroup'">
                    <label class="radio-container">
                        <input type="radio" name="selectType" [checked]="selectedTypes[0] == cellData.data.id" value="{{cellData.data.id}}" 
                            (click)="radioClick($event, cellData)" (mousedown)="$event.stopPropagation();">
                        <span class="checkmark"></span>
                    </label>
                </div>

                <dxo-editing mode="row"
                             [texts]="{confirmDeleteMessage: ''}"
                             [allowUpdating]="true"
                             [allowAdding]="!bulkUpdateMode || selectedKeys?.length">
                </dxo-editing>
            </dx-tree-list>
        </div>
    </div>
</dx-tooltip>
