<app-headline [names]="[ ls.ls(localization, 'Dashboard') ]"
              [text]="ls.ls(localization, 'statistics and reports')"
              icon="globe"
              [showReloadButton]="ui.showReload"
              [showToggleLeftMenuButton]="true"
              [showToggleFilterMenuButton]="true"
              (onToggleLeftMenu)="repaint()"
              (onReload)="refresh()">
    <import-progress-bar></import-progress-bar>
    <calendar-button></calendar-button>
</app-headline>
<div [@routerTransition]>
  <crm-left-menu [showIntroductionTour]="true"
                 (openIntro)="openDialog()"
                 (openPaymentWizard)="openPaymentWizardDialog()">
  </crm-left-menu>
  <div class="widgets-wrapper" [ngClass]="{ expanded: leftMenuCollapsed$ | async }">
      <div class="wrapper">
          <div class="dashboard-stub" *ngIf="showWelcomeSection$ | async">
              <div>
                  <img class="logo-crm" alt="CRM Logo" src="./assets/common/icons/cfo.png" />
                  <span class="sperse-crm big-gray-text">{{ls.ls(localization, 'CRM')}}</span>
              </div>
              <p class="second-line big-gray-text">{{ls.ls(localization, 'CRM_Long')}}</p>
              <p class="welcome-crm">{{ls.ls(localization, 'CRMDashboard_WelcomeText')}}</p>
              <p class="text-crm">{{ls.ls(localization, 'CRMDashboard_StartText')}}</p>
              <p class="manage-crm" *ngIf="hasAnyCGPermission || hasOrdersPermission">
                  {{ls.ls(localization, 'CRMDashboard_ManageText')}}
                  <a *ngIf="hasAnyCGPermission" [routerLink]="['/app/crm/leads']">{{ls.ls(localization, 'Leads')}}</a>
                  <ng-container *ngIf="hasCustomersPermission">
                      , <a [routerLink]="['/app/crm/clients']">{{ls.ls(localization, 'Clients')}}</a>
                  </ng-container>
                  <ng-container *ngIf="hasAnyCGPermission && hasOrdersPermission"> and </ng-container>
                  <a *ngIf="hasOrdersPermission" [routerLink]="['/app/crm/orders']">{{ls.ls(localization, 'Orders')}}</a>
              </p>
              <!-- p class="last-line"><a [routerLink]="['/app/crm/clients']">{{ls.ls(localization, 'CRMDashboard_AddContact')}}</a> | {{ls.ls(localization, 'CRMDashboard_ImportContact')}}</p -->
              <button *ngIf="hasPermissionToAddClient" (click)="addClient()" class="btn btn-layout add-client">{{ ls.ls(localization, 'CRMDashboard_AddClient') }}</button>
          </div>
          <dx-scroll-view *ngIf="showDefaultSection$ | async" showScrollbar="onHover">
              <div class="dashboard-widgets">
                  <counts-and-totals *ngIf="hasAnyCGPermission || isGrantedOrders"></counts-and-totals>
                  <div class="analytics-wrap">
                      <div class="left-side col-xl-4">
                          <new-items-totals *ngIf="hasAnyCGPermission || isGrantedOrders"></new-items-totals>
                          <totals-by-source *ngIf="hasAnyCGPermission"></totals-by-source>
                      </div>
                      <div class="right-side col-xl-8">
                          <ng-container *ngIf="hasAnyCGPermission">
                              <totals-by-period></totals-by-period>
                              <recent-clients></recent-clients>
                          </ng-container>
                      </div>
                  </div>
                  <clients-by-region *ngIf="hasAnyCGPermission"></clients-by-region>
              </div>
          </dx-scroll-view>
          <loading-spinner *ngIf="showLoadingSpinner"></loading-spinner>
      </div>
  </div>
</div>
