<app-headline>
  <calendar-button *ngIf="hasAccessibleCG"></calendar-button>
</app-headline>



<div>
  <crm-left-menu [ngStyle]="{ float: menuSide }" [showIntroductionTour]="!appService.isHostTenant"
    [currentContactGroup]="filterModelContactGroup.items.element.value" (openIntro)="openDialog()">
  </crm-left-menu>
  <div *ngIf="hasAccessibleCG; else noData" class="widgets-wrapper"
    [ngClass]="{ expanded: leftMenuCollapsed$ | async, 'left-nav-menu': layoutService.showLeftBar }"
    [ngStyle]="menuSide === 'left' ? { 'margin-left': '251px' } : { 'margin-right': '251px' }">
    <div class="wrapper">
      <dx-scroll-view *ngIf="showDefaultSection$ | async" showScrollbar="onHover">
        <div class="dashboard-widgets">
          <!-- KPI Cards Section -->
          <div class="kpi-cards-container">
            <app-kpi-card *ngFor="let card of kpiCards" [cardData]="card">
            </app-kpi-card>
          </div>
          <div class="d-flex flex-column chart-container">
            <app-customers-chart [currentPeriodTotal]="245" [percentageChange]="80.15" [startDate]="chartStartDate"
              [endDate]="chartEndDate" [comparisonStartDate]="chartComparisonStartDate"
              [comparisonEndDate]="chartComparisonEndDate" [title]="'Gross Earnings'" [icon]="'attach_money'">
            </app-customers-chart>
          </div>
          <div class="grid grid-cols-2 gap-1">
              <app-customers-chart [currentPeriodTotal]="245" [percentageChange]="80.15" [startDate]="chartStartDate"
                [endDate]="chartEndDate" [comparisonStartDate]="chartComparisonStartDate"
                [comparisonEndDate]="chartComparisonEndDate" [title]="'Customers'" [icon]="'people'">
              </app-customers-chart>
              <app-customers-chart [currentPeriodTotal]="245" [percentageChange]="80.15" [startDate]="chartStartDate"
                [endDate]="chartEndDate" [comparisonStartDate]="chartComparisonStartDate"
                [comparisonEndDate]="chartComparisonEndDate" [title]="'Upgrades'" [icon]="'show_chart'">
              </app-customers-chart>
              <app-customers-chart [currentPeriodTotal]="245" [percentageChange]="80.15" [startDate]="chartStartDate"
                [endDate]="chartEndDate" [comparisonStartDate]="chartComparisonStartDate"
                [comparisonEndDate]="chartComparisonEndDate" [title]="'SHOP ORDERS'" [icon]="'shopping_cart'">
              </app-customers-chart>
              <app-customers-chart [currentPeriodTotal]="245" [percentageChange]="80.15" [startDate]="chartStartDate"
                [endDate]="chartEndDate" [comparisonStartDate]="chartComparisonStartDate"
                [comparisonEndDate]="chartComparisonEndDate" [title]="'CANCELLED'" [icon]="'trending_down'">
              </app-customers-chart>
          </div>
          <clients-by-region *ngIf="hasAnyCGPermission" [waitFor$]="clientsByRegionLoad.asObservable()"
            (loadComplete)="totalsByPeriodLoad.next()">
          </clients-by-region>
        </div>
      </dx-scroll-view>
      <loading-spinner *ngIf="showLoadingSpinner"></loading-spinner>
    </div>
  </div>
  <ng-template #noData>
    <app-no-data> </app-no-data>
  </ng-template>
</div>