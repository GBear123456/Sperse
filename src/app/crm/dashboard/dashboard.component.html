<app-headline [names]="[ l('Dashboard') ]"
              [text]="l('statistics and reports')"
              icon="globe"
              [showReloadButton]="ui.showReload"
              (onReload)="refresh()">
    <import-progress-bar></import-progress-bar>
    <app-period (onChange)="periodChanged($event)"></app-period>
</app-headline>
<div [@routerTransition]>
  <left-menu (openIntro)="openDialog()" (openPaymentWizard)="openPaymentWizardDialog()"></left-menu>
  <div class="widgets-wrapper">
      <div class="wrapper">
          <div class="dashboard-stub" *ngIf="showWelcomeSection$ | async">
              <div>
                  <img class="logo-crm" alt="CRM Logo" src="./assets/common/icons/cfo.png" />
                  <span class="sperse-crm big-gray-text">{{l('CRM')}}</span>
              </div>
              <p class="second-line big-gray-text">{{l('CRM_Long')}}</p>
              <p class="welcome-crm">{{l('CRMDashboard_WelcomeText')}}</p>
              <p class="text-crm">{{l('CRMDashboard_StartText')}}</p>
              <p class="manage-crm" *ngIf="hasCustomersPermission || hasOrdersPermission">
                  {{l('CRMDashboard_ManageText')}}
                  <ng-container *ngIf="hasCustomersPermission">
                      <a [routerLink]="['/app/crm/leads']">{{l('Leads')}}</a>, <a [routerLink]="['/app/crm/clients']">{{l('Clients')}}</a>
                  </ng-container>
                  <ng-container *ngIf="hasCustomersPermission && hasOrdersPermission"> and </ng-container>
                  <a *ngIf="hasOrdersPermission" [routerLink]="['/app/crm/orders']">{{l('Orders')}}</a>
              </p>
              <!-- p class="last-line"><a [routerLink]="['/app/crm/clients']">{{l('CRMDashboard_AddContact')}}</a> | {{l('CRMDashboard_ImportContact')}}</p -->
              <button *ngIf="hasPermissionToAddClient" (click)="addClient()" class="btn btn-layout add-client">{{ l('CRMDashboard_AddClient') }}</button>
          </div>
          <dx-scroll-view *ngIf="showDefaultSection$ | async" showScrollbar="onHover">
              <div class="dashboard-widgets">
                  <counts-and-totals *ngIf="isGrantedCustomers || isGrantedOrders"></counts-and-totals>
                  <div class="analytics-wrap">
                      <div class="left-side col-xl-4">
                          <new-items-totals *ngIf="isGrantedCustomers || isGrantedOrders"></new-items-totals>
                          <totals-by-source *ngIf="isGrantedCustomers"></totals-by-source>
                      </div>
                      <div class="right-side col-xl-8">
                          <totals-by-period *ngIf="isGrantedCustomers"></totals-by-period>
                          <recent-clients *ngIf="isGrantedCustomers"></recent-clients>
                      </div>
                  </div>
                  <clients-by-region *ngIf="isGrantedCustomers"></clients-by-region>
              </div>
          </dx-scroll-view>
          <loading-spinner *ngIf="showLoadingSpinner"></loading-spinner>
      </div>
  </div>
</div>
