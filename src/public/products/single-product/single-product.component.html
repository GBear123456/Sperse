<div *ngIf="showNotFound" class="not-found-block">
    Product link is not valid
</div>
<div *ngIf="productInfo" class="box">
    <div class="title">
        <h1 class="title title--h1"> {{productInfo.name}}</h1>
    </div>
    <p class="subtitle">{{productInfo.description}}</p>
    <div class="box__inner">
        <div class="box__left box__item">
            <div class="plan">
                <span class="wrapper">
                    <span>
                        <img *ngIf="productInfo.imageUrl" aria-hidden="true" [src]="productInfo.imageUrl">
                    </span>
                </span>
            </div>
            <ng-container *ngIf="productInfo.type == productType.Subscription else generalProduct">
                <div class="subscription-price">
                    <div *ngIf="availablePeriods.length > 1" class="state-slider point{{availablePeriods.length}}">
                        <div class="captions">
                            <ng-container *ngFor="let period of availablePeriods; index as i">
                                <div [ngClass]="{ 'active': getActiveStatus(period) }" (click)="toggle(period)">{{ ls.l(billingPeriod[period]) }}</div>
                            </ng-container>
                        </div>
                        <mat-slider [value]="getSliderValue()"
                                    [disabled]="true">
                        </mat-slider>
                    </div>
                    <div class="price-wrapper">
                        <div class="trial-day-count" *ngIf="selectedSubscriptionOption.trialDayCount">
                            <span *ngIf="selectedSubscriptionOption.signupFee; else free">{{ currencySymbol }}{{selectedSubscriptionOption.signupFee | customNumber: '1.0-0' | currency: 'USD' : '' : '1.0-0'}}</span> for {{selectedSubscriptionOption.trialDayCount}}* day(s) then
                            <ng-template #free>{{ls.l('Free')}}</ng-template>
                        </div>
                        <div class="amountPerMonth">
                            <ng-container *ngIf="!isFreeProductSelected else freeOption">
                                <span class="currency-symbol">{{ currencySymbol }}</span>
                                <span class="number">
                                    {{ getPricePerPeriod() | customNumber: '1.0-0' | currency: 'USD' : '' : '1.0-0' }}
                                </span>
                                <div class="number-info">
                                    <span class="decimal">{{ getPricePerPeriod() | customNumber: '0.2-2' }}</span>
                                    <span>/{{ getPriceDescription() }}</span>
                                </div>
                            </ng-container>
                            <ng-template #freeOption>
                                <span class="number">{{ls.l('Free')}}</span>
                            </ng-template>
                        </div>
                        <div class="trial-period-note" *ngIf="selectedSubscriptionOption.trialDayCount">{{ls.l('* The Trial period is applied after the first purchase only.')}}</div>
                    </div>
                </div>
            </ng-container>
            <ng-template #generalProduct>
                <div class="price">
                    <ng-container *ngIf="!isFreeProductSelected else freeProduct">
                        <div class="quantity">
                            <div class="quantity-title">Quantity</div>
                            <div class="quantity-controls">
                                <span [style.visibility]="requestInfo.quantity > 1 ? 'visible' : 'hidden'" (click)="changeQuantity(requestInfo.quantity - 1)">-</span>
                                <span class="value">{{requestInfo.quantity}}</span>
                                <span (click)="changeQuantity(requestInfo.quantity + 1)">+</span>
                            </div>
                        </div>
                        <div class="price__new">
                            <span>{{ (productInfo.price * requestInfo.quantity) | number : '1.0-2'}}</span>
                        </div>
                    </ng-container>
                    <ng-template #freeProduct>
                        <div class="free-product">{{ls.l('Free')}}</div>
                    </ng-template>
                </div>
            </ng-template>
            <div *ngIf="descriptionHtml" class="description-html" [innerHtml]="descriptionHtml"></div>
        </div>
        <div class="box__right box__item">
            <form id="firstStepForm" #firstStepForm="ngForm" novalidate>
                <div class="name">
                    <div class="input name__input">
                        <label>
                            First Name <input #firstNameInput="ngModel" type="text" placeholder="" name="firstName" [(ngModel)]="requestInfo.firstName" [ngModelOptions]="{updateOn: 'blur'}" [pattern]="nameRegexp" required>
                            <validation-messages [formCtrl]="firstNameInput" [errorDefs]="[{pattern: ls.l('{0}IsInvalid', ls.l('FirstName'))}]"></validation-messages>
                        </label>
                    </div>
                    <div class="input name__input">
                        <label>
                            Last Name <input #lastNameInput="ngModel" type="text" placeholder="" name="lastName" [(ngModel)]="requestInfo.lastName" [ngModelOptions]="{updateOn: 'blur'}" [pattern]="nameRegexp" required>
                            <validation-messages [formCtrl]="lastNameInput" [errorDefs]="[{pattern: ls.l('{0}IsInvalid', ls.l('LastName'))}]"></validation-messages>
                        </label>
                    </div>
                </div>
                <div class="phone">
                    <span class="phone__label">Phone</span>
                    <div>
                        <country-phone-number #phoneNumber
                                              [required]="false"
                                              [(phoneNumber)]="requestInfo.phone">
                        </country-phone-number>
                    </div>
                </div>
                <div class="input">
                    <label class="email">
                        Email Address <input #emailAddressInput="ngModel" type="email" name="email" placeholder="" [(ngModel)]="requestInfo.email" [ngModelOptions]="{updateOn: 'blur'}" [pattern]="emailRegexp" required>
                        <validation-messages [formCtrl]="emailAddressInput" [errorDefs]="[{pattern: ls.l('InvalidEmailAddress')}]"></validation-messages>
                    </label>
                </div>
                <div class="actions">
                    <div>
                        <label class="check_wrap">
                            <input class="check_wrap__input" type="checkbox" [(ngModel)]="agreedTermsAndServices" [ngModelOptions]="{standalone: true}">
                            <span class="check_wrap__style"></span>
                            <div>
                                By using this page, you agree to <a href="javascript:void(0);" (click)="openConditionsDialog(conditions.Terms)">Sperse Terms of Service</a> and <a href="javascript:void(0);" (click)="openConditionsDialog(conditions.Policies)">Privacy Policy</a>.
                            </div>
                        </label>
                    </div>
                </div>
                <div class="login_btn">
                    <div [style.display]="isFreeProductSelected ? 'block' : 'none'">
                        <button class="button_global button_global_green" [ngClass]="{disabled: !isFormValid()}" (click)="submitFreeRequest()">
                            {{ productInfo.type == productType.Subscription ? 'Subscribe' : 'Purchase' }}
                        </button>
                    </div>
                    <div class="gateways" [style.display]="!isFreeProductSelected ? 'flex' : 'none'">
                        <button class="button_global button_global_purple" [ngClass]="{disabled: !isFormValid()}" (click)="submitStripeRequest()">
                            Pay with <img src="assets/common/images/stripe.svg" />
                        </button>
                        <pay-pal *ngIf="productInfo.data.paypalClientId"
                                 [height]="55"
                                 [disabled]="!isFormValid()"
                                 (onApprove)="onPayPalApprove()">
                        </pay-pal>
                    </div>
                </div>
            </form>
        </div>
    </div>
    <div class="footer">
        {{currentYear}} &copy; Sperse Platform
    </div>
</div>
