<div *ngIf="loading; else mainContainer" class="loading-container">
    <div class="wait-message">
        Waiting for invoice information
    </div>
</div>
<ng-template #mainContainer>
    <div class="header">
        <div class="content-center header-content">
            <h3>
                Invoice <b>{{invoiceInfo.invoiceData.number}}</b>
            </h3>
            <div>
                <button type="button" class="btn btn-secondary" (click)="printPage()">
                    Print
                </button>
                <a role="button" class="btn btn-primary" [class.disabled]="!invoiceInfo.stripePayUrl" href="{{invoiceInfo.stripePayUrl}}">
                    Pay with Stripe
                </a>
            </div>
        </div>
    </div>
    <div class="content content-center">
        <div class="content-logo">
            <img src="{{invoiceInfo.tenantLogo}}">
        </div>
        <div class="inline-block full-width content-top-info">
            <div class="left width-60">
                <div class="invoice-title">INVOICE</div>
                <div class="customer-info">
                    {{invoiceInfo.invoiceData.customerName}}<br>
                    {{invoiceInfo.invoiceData.customerAddressLine1}}<br>
                    {{invoiceInfo.invoiceData.customerAddressLine2}}
                </div>
            </div>
            <div class="inline-block left width-40">
                <div class="left width-50">
                    <p class="margin-top-0">
                        <b>Invoice Date</b><br>
                        {{invoiceInfo.invoiceData.date | date: 'dd MMM yyyy'}}
                    </p>
                    <p>
                        <b>Invoice Number</b><br>
                        {{invoiceInfo.invoiceData.number}}
                    </p>
                </div>
                <div class="left width-50 pre-line">
                    {{invoiceInfo.legalName}}<br>
                    {{invoiceInfo.legalAddress}}
                </div>
            </div>
        </div>

        <table class="items-table full-width" cellspacing="0">
            <thead>
                <tr>
                    <th >Description</th>
                    <th class="text-right">Quantity</th>
                    <th class="text-right">Unit Price</th>
                    <th class="text-right">Amount USD</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let lineItem of invoiceInfo.invoiceData.items">
                    <td>{{lineItem.description}}</td>
                    <td align="right">{{lineItem.quantity | number: '1.0-0'}}</td>
                    <td align="right">{{lineItem.unitPrice | number: '1.2-2'}}</td>
                    <td align="right">{{lineItem.amount | number: '1.2-2'}}</td>
                </tr>

                <tr class="footer-row">
                    <td></td>
                    <td colspan="2"><b>Sub Total USD</b></td>
                    <td><b>{{invoiceInfo.invoiceData.subTotal | number: '1.2-2'}}</b></td>
                </tr>
                <tr class="footer-row">
                    <td></td>
                    <td colspan="2"><b>Discount Total USD</b></td>
                    <td><b>{{invoiceInfo.invoiceData.discountTotal | number: '1.2-2'}}</b></td>
                </tr>
                <tr class="footer-row">
                    <td></td>
                    <td colspan="2"><b>Shipping Total USD</b></td>
                    <td><b>{{invoiceInfo.invoiceData.shippingTotal | number: '1.2-2'}}</b></td>
                </tr>
                <tr class="footer-row">
                    <td></td>
                    <td colspan="2"><b>Tax Total USD</b></td>
                    <td><b>{{invoiceInfo.invoiceData.taxTotal | number: '1.2-2'}}</b></td>
                </tr>
                <tr class="footer-row">
                    <td></td>
                    <td colspan="2"><b>Total USD</b></td>
                    <td><b>{{invoiceInfo.invoiceData.grandTotal | number: '1.2-2'}}</b></td>
                </tr>
            </tbody>
        </table>
        <p *ngIf="invoiceInfo.invoiceData.description" class="pre-line">{{invoiceInfo.invoiceData.description}}</p>
        <p>
            <b>Due Date: {{invoiceInfo.invoiceData.dueDate | date: 'dd MMM yyyy'}}</b><br>
        </p>

        <p *ngIf="invoiceInfo.invoiceData.note" class="pre-line">{{invoiceInfo.invoiceData.note}}</p>
    </div>
    <div class="footer gray content-center">
        <div class="powered-by">
            {{currentYear}} &copy; Sperse Platform
        </div>
        <div class="links">
            <a (click)="openConditionsDialog(conditions.Terms)">Terms</a>
            <a (click)="openConditionsDialog(conditions.Policies)">Privacy</a>
        </div>
    </div>
</ng-template>