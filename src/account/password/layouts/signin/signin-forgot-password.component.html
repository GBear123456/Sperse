<div class="box">
    <form [hidden]="detectedTenancies" *ngIf="!isRequestSent; else verification" class="forgot" #forgotPassForm="ngForm" method="post" novalidate (ngSubmit)="sendRequest()">
        <div class="box__inner">
            <div class="box__title">
                <h1 class="title title--h1">Forgot Your Password?</h1>
            </div>
            <p class="text">
                Enter Your email to receive your verification code and password
                reset link
            </p>
            <div class="input">
                <i class="email-icon"></i><input type='email' #emailAddressInput="ngModel" [(ngModel)]="model.emailAddress" [ngModelOptions]="{updateOn: 'change'}" autoFocus autocomplete="off" placeholder="{{ls.l('EmailAddress')}} *" name="emailAddress" required maxlength="256" email [pattern]="emailRegex"/>
                <validation-messages [formCtrl]="emailAddressInput" [errorDefs]="[{pattern: ls.l('InvalidEmailAddress')}]"></validation-messages>
            </div>
            <div class="send_btn">
                <button type="submit" class="button_global button_global_green"
                        [ngClass]="{disabled: !model?.emailAddress}"
                        [buttonBusy]="saving"
                        [busyText]="ls.l('SavingWithThreeDot')">
                    {{ls.l("Send Email Verification")}}
                </button>
            </div>
            <div class="back"> 
                <a class="A_link" [ngClass]="{disabled: saving}" routerLink="/account/signin" [queryParams]="{extlogin: isExtLogin}">Go back to the sign in page</a>
            </div>
        </div>
    </form>
    <div *ngIf="detectedTenancies?.length > 1">
        <p class="select-tenant">{{ls.l('SelectTenant_Information')}}</p>
        <div class="list-group">
            <a class="list-group-item list-group-item-action" *ngFor="let tenant of detectedTenancies" (click)="sendRequest(false, tenant.id)">
                <h5 class="mb-1">{{tenant.name}}</h5>
            </a>
        </div>
    </div>
    <ng-template #verification>
        <div class="box__inner">
            <signin-login-verification 
                [emailAddress]="model.emailAddress"
                (onCodeRefresh)="sendRequest(true)">
            </signin-login-verification>
        </div>
    </ng-template>
</div>